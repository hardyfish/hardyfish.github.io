<!DOCTYPE html>
<html lang="en" oncontextmenu="return false;">

<head oncontextmenu="return false;">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="baidu-site-verification" content="codeva-QodU0Nk5F7" />
	<meta name="google-site-verification" content="DbSTw8OJwtH5Qei7n8Jnew0YyQ5naPzdLAPiscu7zQE" />
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">

	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?7eeb54583579fabc0878be210d6ad60a";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>

	
	<!-- title -->
	
	<title>
	
		群组系统 | 
	 
	月伴飞鱼
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/%E5%A4%B4%E5%83%8F.jpg">
	
  
  	
<link rel="stylesheet" href="/css/main.css">

  	
<link rel="stylesheet" href="/css/reward.css">

	
<link rel="stylesheet" href="/css/jquery.fancybox.min.css">

	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="/lib/highlight/darcula.css">

	
<link rel="stylesheet" href="/css/clipboard-use.css">


	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>


	
<script src="/lib/highlight/highlight.min.js"></script>


	
<script src="https://readmore.openwrite.cn/js/readmore-2.0.js"></script>

	
<script src="/lib/jquery-3.4.1.min.js"></script>

	
<script src="/lib/jquery.pjax.js"></script>


	
<script src="/js/main.js"></script>

	
<script src="/js/jquery.fancybox.min.js"></script>

	
		
<script src="/lib/valine/av-3.0.4-min.js"></script>

		
<script src="/lib/valine/Valine-1.3.10-min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
	
<script src="/js/clipboard.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body oncontextmenu="return false;">
	<header id="header" oncontextmenu="return false;">
    <a id="title" href="/" class="logo">公众号月伴飞鱼</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">关于我</a>
		</li>

		<li class="menu-item">
			<a href="/个人微信.jpeg" class="menu-item-link">联系作者</a>
		</li>

	    <li class="menu-item">
			<a href="/site" class="menu-item-link">关于网站</a>
		</li>

		<li class="menu-item">
			<a href="/个人公众号.jpg" class="menu-item-link" target="_blank">我的公众号</a>
		</li>
		
		<li class="menu-item">
			<a href="https://tech.meituan.com/" class="menu-item-link" target="_blank">
				美团技术团队
			</a>
		</li>
		<li class="menu-item">
			<a href="https://tech.youzan.com/" class="menu-item-link" target="_blank">
				有赞技术团队
			</a>
		</li>
		<!--<li class="menu-item">
			<select class="menu-item-link menu-item-select">
				<option class="menu-item-link"  value="volvo">Volvo</option>
				<option class="menu-item-link"  value="saab">Saab</option>
				<option class="menu-item-link"  value="fiat">Fiat</option>
				<option class="menu-item-link"  value="audi">Audi</option>
			</select>
		</li>-->
	</ul>
</header>

	<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="text" placeholder="按目录搜索一下">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										AI相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/01/14/AI%E7%9B%B8%E5%85%B3/AIGC/">
										AIGC
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/03/AI%E7%9B%B8%E5%85%B3/ChatGPT/">
										ChatGPT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/07/AI%E7%9B%B8%E5%85%B3/Sora/">
										Sora
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/01/AI%E7%9B%B8%E5%85%B3/%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B/">
										提示词工程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										个人相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/HBase%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">
										HBase最佳实践
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F/">
										交易系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E5%88%97%E8%A1%A8%E7%B3%BB%E7%BB%9F/">
										列表系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/21/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E5%95%86%E5%93%81%E7%B3%BB%E7%BB%9F/">
										商品系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90/">
										学习资源
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E5%B9%BF%E5%91%8A%E7%B3%BB%E7%BB%9F/">
										广告系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E5%BA%93%E5%AD%98%E7%B3%BB%E7%BB%9F/">
										库存系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/">
										生活相关
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E7%94%B5%E5%95%86%E7%B3%BB%E7%BB%9F/">
										电商系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E7%9B%B8%E5%85%B3%E5%8D%9A%E4%B8%BB/">
										相关博主
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7/">
										相关工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E7%BE%A4%E7%BB%84%E7%B3%BB%E7%BB%9F/">
										群组系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/21/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E8%90%A5%E9%94%80%E7%B3%BB%E7%BB%9F/">
										营销系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/21/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E8%B5%84%E6%BA%90%E4%BD%8D%E7%B3%BB%E7%BB%9F/">
										资源位系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E8%BD%AC%E4%BB%8B%E7%BB%8D/">
										转介绍
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F/">
										配置系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										中间件
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/30/%E4%B8%AD%E9%97%B4%E4%BB%B6/Dubbo/">
										Dubbo
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/19/%E4%B8%AD%E9%97%B4%E4%BB%B6/Elasticsearch/">
										Elasticsearch
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/30/%E4%B8%AD%E9%97%B4%E4%BB%B6/Netty/">
										Netty
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/25/%E4%B8%AD%E9%97%B4%E4%BB%B6/Solr/">
										Solr
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/19/%E4%B8%AD%E9%97%B4%E4%BB%B6/ZooKeeper/">
										ZooKeeper
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										产品相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/02/18/%E4%BA%A7%E5%93%81%E7%9B%B8%E5%85%B3/%E5%B9%BF%E5%91%8A%E4%B8%9A%E5%8A%A1/">
										广告业务
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/18/%E4%BA%A7%E5%93%81%E7%9B%B8%E5%85%B3/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/">
										推荐系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/06/%E4%BA%A7%E5%93%81%E7%9B%B8%E5%85%B3/%E7%94%A8%E6%88%B7%E5%A2%9E%E9%95%BF/">
										用户增长
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										代码思想
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/15/%E4%BB%A3%E7%A0%81%E6%80%9D%E6%83%B3/CodeReview/">
										CodeReview
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E4%BB%A3%E7%A0%81%E6%80%9D%E6%83%B3/%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/">
										代码重构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										前端相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/CSS/">
										CSS
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/26/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/React/">
										React
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/26/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/Vue/">
										Vue
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/12/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">
										小程序
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										基础知识
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/11/27/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/JVM/">
										JVM
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%88%86%E5%B8%83%E5%BC%8F/">
										分布式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/10/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">
										并发编程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
										设计模式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										大数据相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/02/21/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/DataX/">
										DataX
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/25/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Doris/">
										Doris
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/20/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Flink/">
										Flink
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/21/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Hadoop/">
										Hadoop
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/07/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Hive/">
										Hive
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/23/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/SQOOP/">
										SQOOP
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/20/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Spark/">
										Spark
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习专栏
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/04/05/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/22%E8%AE%B2%E9%80%9A%E5%85%B3Go%E8%AF%AD%E8%A8%80/">
										22讲通关Go语言
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/25/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/23%E8%AE%B2%E6%90%9E%E5%AE%9A%E5%90%8E%E5%8F%B0%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98/">
										23讲搞定后台架构实战
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/18/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/Dubbo%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%AE%9E%E6%88%98/">
										Dubbo源码解读与实战
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/16/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%9E%B6%E6%9E%84/">
										从0开始学架构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E4%BB%A3%E7%A0%81%E4%B9%8B%E4%B8%91/">
										代码之丑
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E5%A4%A7%E5%8E%82%E6%99%8B%E5%8D%87%E6%8C%87%E5%8D%97/">
										大厂晋升指南
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/19/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E5%A6%82%E4%BD%95%E6%88%90%E4%B8%BA%E5%AD%A6%E4%B9%A0%E9%AB%98%E6%89%8B/">
										如何成为学习高手
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习书籍
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/02/05/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/HBase%E4%B8%8D%E7%9D%A1%E8%A7%89%E4%B9%A6/">
										HBase不睡觉书
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/02/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">
										Java并发编程实战
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/02/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%9A%84%E8%89%BA%E6%9C%AF/">
										Java并发编程的艺术
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/16/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/">
										Java开发手册
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/22/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/MySQL%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95/">
										MySQL技术内幕
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/23/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/">
										Redis设计与实现
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/11/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/%E4%BA%BF%E7%BA%A7%E6%B5%81%E9%87%8F%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/">
										亿级流量网站架构核心技术
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/05/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/">
										代码整洁之道
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/03/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/%E5%A4%A7%E5%9E%8B%E7%BD%91%E7%AB%99%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84/">
										大型网站技术架构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/07/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/%E5%A4%A7%E5%9E%8B%E7%BD%91%E7%AB%99%E7%B3%BB%E7%BB%9F/">
										大型网站系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/06/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/">
										深入理解Java虚拟机
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/08/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/%E8%8B%B1%E8%AF%AD%E9%AD%94%E6%B3%95%E5%B8%88%E4%B9%8B%E8%AF%AD%E6%B3%95%E4%BF%B1%E4%B9%90%E9%83%A8/">
										英语魔法师之语法俱乐部
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										工具相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Arthas/">
										Arthas
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/24/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/ChatGPT/">
										ChatGPT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/21/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/GIT/">
										GIT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/21/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Hexo/">
										Hexo
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/21/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/MAC/">
										MAC
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/01/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Maven/">
										Maven
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/09/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/PlantUML/">
										PlantUML
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/22/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/UTools/">
										UTools
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/">
										实用工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										成长相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/03/26/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E5%B7%A5%E4%BD%9C%E7%9B%B8%E5%85%B3/">
										工作相关
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/">
										技术学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/07/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92/">
										读书计划
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E9%9D%A2%E8%AF%95%E7%9B%B8%E5%85%B3/">
										面试相关
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										数据库
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/02/06/%E6%95%B0%E6%8D%AE%E5%BA%93/ClickHouse/">
										ClickHouse
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/27/%E6%95%B0%E6%8D%AE%E5%BA%93/HBase/">
										HBase
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E6%95%B0%E6%8D%AE%E5%BA%93/MongoDB/">
										MongoDB
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/02/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/">
										MySQL
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/21/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/">
										Redis
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/07/%E6%95%B0%E6%8D%AE%E5%BA%93/TIDB/">
										TIDB
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										文章速读
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/03/18/%E6%96%87%E7%AB%A0%E9%80%9F%E8%AF%BB/%E5%A4%A7%E5%8E%82%E6%96%87%E7%AB%A0/">
										大厂文章
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										服务器
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%9C%8D%E5%8A%A1%E5%99%A8/Docker/">
										Docker
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E6%9C%8D%E5%8A%A1%E5%99%A8/Nginx/">
										Nginx
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/03/%E6%9C%8D%E5%8A%A1%E5%99%A8/Tomcat/">
										Tomcat
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E8%BF%90%E7%BB%B4%E7%9F%A5%E8%AF%86/">
										运维知识
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										架构相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/21/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/DDD/">
										DDD
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E6%9E%B6%E6%9E%84%E5%9B%BE/">
										架构图
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0/">
										架构学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E4%BF%9D%E9%9A%9C/">
										系统保障
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD/">
										系统性能
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">
										系统设计
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										框架相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/01/07/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Caffeine/">
										Caffeine
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/06/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Guava/">
										Guava
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/15/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/JWT/">
										JWT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/MyBatis/">
										MyBatis
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/14/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/RPC%E6%A1%86%E6%9E%B6/">
										RPC框架
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/26/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Seata/">
										Seata
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/03/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/ShardingSphere/">
										ShardingSphere
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/14/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Spring/">
										Spring
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/03/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Thrift/">
										Thrift
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/29/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/XXLJOB/">
										XXLJOB
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
										开源框架
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										消息队列
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/KAFKA/">
										KAFKA
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/20/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RabbitMQ/">
										RabbitMQ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RocketMQ/">
										RocketMQ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										源码相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/13/%E6%BA%90%E7%A0%81%E7%9B%B8%E5%85%B3/RocketMQ/">
										RocketMQ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										生活相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/02/24/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E6%B3%95%E5%BE%8B/">
										法律
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/17/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E7%83%B9%E9%A5%AA/">
										烹饪
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E7%94%B5%E5%BD%B1/">
										电影
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/10/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E7%94%B5%E8%A7%86%E5%89%A7/">
										电视剧
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/11/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E7%BA%AA%E5%BD%95%E7%89%87/">
										纪录片
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E9%9F%B3%E4%B9%90/">
										音乐
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										算法相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/11/26/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/LeetCode/">
										LeetCode
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/26/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/%E5%89%91%E6%8C%87OFFER/">
										剑指OFFER
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/25/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/%E9%9D%A2%E8%AF%95%E7%AE%97%E6%B3%95/">
										面试算法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										编程语言
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/04/05/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go%E5%9F%BA%E7%A1%80/">
										Go基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/21/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java%E5%9F%BA%E7%A1%80/">
										Java基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/29/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Python%E5%9F%BA%E7%A1%80/">
										Python基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										英语相关
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										摩登家庭
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/03/05/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E6%91%A9%E7%99%BB%E5%AE%B6%E5%BA%AD/%E7%AC%AC%E4%B8%80%E5%AD%A3/">
										第一季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										老友记
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%B8%80%E5%AD%A3/">
										第一季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%B8%89%E5%AD%A3/">
										第三季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/23/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%BA%94%E5%AD%A3/">
										第五季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										雅思
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/01/25/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E9%9B%85%E6%80%9D/%E5%89%91%E6%A1%A5%E9%9B%85%E6%80%9D%E5%90%AC%E5%8A%9B%E7%9C%9F%E9%A2%9815/">
										剑桥雅思听力真题15
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/12/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E9%9B%85%E6%80%9D/%E5%89%91%E6%A1%A5%E9%9B%85%E6%80%9D%E5%90%AC%E5%8A%9B%E7%9C%9F%E9%A2%984/">
										剑桥雅思听力真题4
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/08/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E9%9B%85%E6%80%9D/%E9%9B%85%E6%80%9D%E9%98%85%E8%AF%BB538%E8%80%83%E7%82%B9%E8%AF%8D/">
										雅思阅读538考点词
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										计算机基础
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
										操作系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
										数据结构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86/">
										算法知识
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/19/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">
										网络基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title" oncontextmenu="return false;">

	群组系统
</h1>
<div class="article-meta" oncontextmenu="return false;">
	<span>月伴飞鱼</span>
	<span>2024-05-20 18:17:04</span>
    
		<div id="article-categories">
            
                
                    <span>
                        <i class="fa fa-folder" aria-hidden="true"></i>
                        <a href="/categories/个人相关/">个人相关</a>
						
                    </span>
                
            
		</div>
    
</div>

<div id="container" class = "content999" oncontextmenu="return false;">
<!--打赏-->
        <div class="reward">
       <div class="reward-button">赏 <span class="reward-code">
        <span class="alipay-code"> <img class="alipay-img wdp-appear" src="/alipay.png"><b>支付宝打赏</b> </span> 
        <span class="wechat-code"> <img class="wechat-img wdp-appear" src="/weipay.jpeg"><b>微信打赏</b> </span> 
       </div>
      <p class="reward-notice">如果文章对你有帮助，欢迎点击上方按钮打赏作者！</p>
      </div>
      <!--打赏-->
	<div id="article-content">
		<p><strong>背景介绍</strong></p>
<p>目前小斑斑缺失：通过用户标签的组合，筛选出满足组合规则的用户，实施对应的精细化运营策略的能力。</p>
<p>使用场景如：直播售卖，触达，首页Banner等。</p>
<p><strong>概念定义：</strong></p>
<p>用户标签：</p>
<ul>
<li>基于用户行为，为具备相同特征的用户打上的标签。</li>
</ul>
<p>用户群组：</p>
<ul>
<li>取一个&#x2F;多个用户标签，通过取交集&#x2F;并集的方式，形成的集合。</li>
</ul>
<p><strong>系统目标</strong></p>
<p>该系统需要提供以下能力：</p>
<table>
<thead>
<tr>
<th align="left">模块</th>
<th align="left">能力描述</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">B端</td>
<td align="left">标签：批量查询标签信息   查询标签信息新增标签群组：查询群组信息查询群组用户数新建用户群组更新用户群组删除用户群组</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">C端</td>
<td align="left">标签：异步添加用户标签   查询用户持有的所有标签   批量查询用户持有的所有标签刷新用户标签 群组：用户是否在某群组中异步获取群组内所有用户批量查询一批用户是否在群组中</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><strong>详细方案</strong></p>
<p><strong>方案调研</strong></p>
<p>调研了斑马，猿辅导，工具中台的方案：</p>
<ul>
<li>斑马和工具中台：基本一致，依赖数仓较多，主要依赖数仓做数据同步和数据计算。</li>
<li>猿辅导：没有依赖数仓，业务场景简单，只有下单才打标签，QPS低，不用考虑性能，实现方案也比较简单。</li>
</ul>
<p>小斑斑和斑马的业务场景相似，所以以下方案，参考斑马和工具中台的设计。</p>
<p><strong>标签存储</strong></p>
<p><strong>需要支持的能力：</strong></p>
<table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">具体内容</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">读</td>
<td align="left">根据(userId，tag)的读批量（userId，tag）读根据userId查询所有tag根据tag和tag下value查询userId举例：查询同时满足以下条件的用户：1、在课时长&gt;1天2、年龄&gt;1岁</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">写</td>
<td align="left">根据userId批量修改tag根据userId批量添加tag</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">删</td>
<td align="left">根据userId删除tag</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><strong>基本方案</strong></p>
<p>选择竖表 + 搜索引擎的方式。</p>
<p>竖表：</p>
<ul>
<li>主要用于C端高QPS的用户标签批量的写入更新。</li>
</ul>
<p>搜索引擎：</p>
<ul>
<li>用于根据标签组合筛选符合条件的用户，批量写入性能比较差。</li>
</ul>
<p><strong>技术选型</strong></p>
<p><strong>竖表：</strong></p>
<p>数据结构：</p>
<table>
<thead>
<tr>
<th align="left">字段名</th>
<th align="left">类型</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">id</td>
<td align="left">int</td>
<td align="left">记录主键，可能是ytkId，solarId，deviceId等</td>
</tr>
<tr>
<td align="left">tag</td>
<td align="left">string</td>
<td align="left">标签名</td>
</tr>
<tr>
<td align="left">updatedTime</td>
<td align="left">int</td>
<td align="left">更新时间，单位秒</td>
</tr>
<tr>
<td align="left">value</td>
<td align="left">string</td>
<td align="left">标签值</td>
</tr>
</tbody></table>
<p>数据存储：</p>
<table>
<thead>
<tr>
<th align="left">存储方案</th>
<th align="left">详细内容</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">存储方案</td>
<td align="left">详细内容</td>
<td align="left">备注</td>
</tr>
<tr>
<td align="left">MySQL</td>
<td align="left">拓展性比较差性能不满足要求</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">hbase增强版</td>
<td align="left">可以满足竖表的要求阿里云还提供了<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/88404.html?spm=a2c4g.11174283.6.579.22be3c2eV0T2cH%EF%BC%8Chbase">https://help.aliyun.com/document_detail/88404.html?spm=a2c4g.11174283.6.579.22be3c2eV0T2cH，hbase</a> + solr 的方案，提供全文搜索能力</td>
<td align="left">文档：</td>
</tr>
<tr>
<td align="left">mongodb</td>
<td align="left">性能可以保证。es提供了mongoDb作为数据源的插件，导数据比较方便。mongodb不能很好满足：根据tag和tag下value查询userId，还是需要一个搜索引擎来处理。MongoDb，公司内部应用不多，没有hbase应用成熟。</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><strong>搜索引擎：</strong></p>
<table>
<thead>
<tr>
<th align="left">方案</th>
<th align="left">详细内容</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ES</td>
<td align="left">优势：公司内应用较为成熟，方便解决各种问题es的数据分析能力比solr强，solr更倾向于全文搜索es在索引时性能更好不足：阿里云目前尚未提供hbase数据直接同步到es的能力，因此需要在代码中双写。</td>
<td align="left">工具平台抄了个开源项目，用作hbase同步到es：orion-tag&#x2F;orion-tag-sync</td>
</tr>
<tr>
<td align="left">Solr</td>
<td align="left">优势：hbase增强版自身具备hbase宽表→ slor的数据同步能力，可以解决数据同步问题，因此服务端无需保证数据的一致性。不足：公司内部应用不成熟。</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><strong>存储模型</strong></p>
<p>采用宽表形式存储：</p>
<ul>
<li>rowKey：前缀+用户身份标识，如userId为1234的rowkey为“USER_1234”。</li>
<li>列：用户的标签属性。</li>
</ul>
<table>
<thead>
<tr>
<th align="left">rowkey</th>
<th align="left">tag1</th>
<th align="left">tag2</th>
<th align="left">…</th>
</tr>
</thead>
<tbody><tr>
<td align="left">USER_uid1</td>
<td align="left"><code>attr_u_c_oversea_region</code></td>
<td align="left">attr_u_c_region</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>用户标签存入在HBase中，用户userId作为rowKey，标签Key、Value作为列名与列值。用户标签存储在HBase中可以根据userId(rowKey)快速查出用户的标签。</p>
<p>注意点：</p>
<ul>
<li>目前咨询阿里云宽表列数限制大概为1500列左右，对应我们1500个标签。</li>
<li>目前业务上一个用户应该不会超过1500个标签的情况，后续超过了，再进行拆分和合并处理。</li>
</ul>
<p><strong>标签聚合</strong></p>
<p>有一些场景，我们需要根据用户不同身份的标签进行聚合。</p>
<p>一个用户可以用不同的<strong>身份标识：</strong>如userId, deviceId, unionId, phone等多种维度进行标签的存储，一旦不同身份标识之间产生了关联关系，需要将数据重新聚合计算。</p>
<ul>
<li>如deviceId1浏览落地页1次，userId1也浏览了1次，一旦userId1和deviceId1进行了绑定，则需要将userId和deviceId的数据进行关联，并将浏览次数进行汇总。</li>
</ul>
<p>不用身份的用户标签：其存储结构如下表。其中rowkey采用的是前缀+value值的形式。</p>
<table>
<thead>
<tr>
<th align="left">rowKey</th>
<th align="left">userId</th>
<th align="left">deviceId</th>
<th align="left">unionId</th>
<th align="left">phone</th>
<th align="left">tempUserId</th>
</tr>
</thead>
<tbody><tr>
<td align="left">USER_1234</td>
<td align="left">1234</td>
<td align="left">jojohihii</td>
<td align="left">u1</td>
<td align="left">100000000</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">UNION_okagjjgjhj</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<p><strong>基本方案</strong></p>
<p><strong>方案一：</strong></p>
<p>依赖于数仓T+1维度的计算结果。</p>
<p>数仓计算完之后直接将数据导入到hbase宽表中，大致流程如下：</p>
<p><img src="/images/718.png" alt="图片1"></p>
<p>例如：</p>
<table>
<thead>
<tr>
<th align="left">userId</th>
<th align="left">deviceId</th>
<th align="left">unionId</th>
<th align="left">age</th>
<th align="left">visitTimes</th>
</tr>
</thead>
<tbody><tr>
<td align="left">u1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">3</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">d1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">4</td>
</tr>
</tbody></table>
<p>这种格式会在hbase库中分别插入两条记录</p>
<table>
<thead>
<tr>
<th align="left">rowKey</th>
<th align="left">age</th>
<th align="left">visitTimes</th>
</tr>
</thead>
<tbody><tr>
<td align="left">u1</td>
<td align="left">3</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">d1</td>
<td align="left"></td>
<td align="left">4</td>
</tr>
</tbody></table>
<p>当u1和d1产生绑定关系之后，需要将现有的d1标签删除，同时将d1的原有数据聚合到u1上，则需要传输的协议大致类似于：</p>
<table>
<thead>
<tr>
<th align="left">userId</th>
<th align="left">type</th>
<th align="left">deviceId</th>
<th align="left">type</th>
<th align="left">unionId</th>
<th align="left">age</th>
<th align="left">visitTimes</th>
</tr>
</thead>
<tbody><tr>
<td align="left">u1</td>
<td align="left">update</td>
<td align="left">d1</td>
<td align="left">delete</td>
<td align="left"></td>
<td align="left">3</td>
<td align="left">6</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>该协议标识u1的原有标签需要保留，d1的原有标签需要删除，同时visitTimes等标签已经将原有的标签进行了聚合。</p>
<p>该方案的不足在于：</p>
<ul>
<li>数据的同步流程过长，出现问题都会有一定的排查难度，需要跨组沟通排查数据同步问题</li>
<li>需要数仓同学支持</li>
</ul>
<p><strong>方案二：</strong></p>
<p>感知用户身份的变更关系，针对不同的语义做出不同的数据处理动作。</p>
<p>主要工作包含：</p>
<ul>
<li>定时job拉取hdfs数据</li>
<li>解析hdfs数据，根据不同的语义执行不同的数据处理动作</li>
</ul>
<p>除此之外，还需要维护每个用户不同身份之间的绑定关系，目前采用上述的属性标签同样存储的方式。如u1和d1产生了绑定关系，则需更新u1数据，同时删除d1数据，参考上面。</p>
<p>该方案的不足在于：</p>
<ul>
<li>处理逻辑复杂，容易出错。</li>
<li>无法保证处理完成的时间。</li>
</ul>
<p><strong>标签生产</strong></p>
<p>标签数据根据生产方大致可分为：</p>
<ul>
<li>业务标签：此类标签由各业务自行定义，标签系统提供写&#x2F;读接口，此类标签数据由电商辅导服务等业务研发自行写入。</li>
<li>数仓标签：此类标签比较杂，包罗万象，包括用户数据，埋点数据等，统一由数仓与各业务对接取数逻辑，然后向标签系统中写入数据。</li>
</ul>
<p>历史数据：</p>
<ul>
<li>全量用户打标签，一次性Job。</li>
</ul>
<p>增量数据：</p>
<ul>
<li>新增标签：全量刷新用户标签。</li>
<li>用户行为变更，如退课，退费等：实时刷新用户标签。</li>
</ul>
<p>后续标签的生产可以按照以下流程推进：</p>
<ul>
<li>业务提需求，需要支持 XX 标签，后端开发。<ul>
<li>标签产品根据标签的实际计算&#x2F;使用逻辑，进行处理：<ul>
<li>如果标签是业务强相关的，是依赖业务表&#x2F;相关逻辑计算出来的标签值的话 → 由各业务自行生产</li>
<li>如果标签与业务逻辑关联性不大，并且标签也不是很核心的话，或者数据源是商分的数据报表的话，如用户年龄、用户IP地址等 → 由数仓写入数据</li>
</ul>
</li>
</ul>
</li>
<li>标签系统提供管理后台，新增标签时事先在标签后台维护好标签元数据信息（标签值格式），再通过标签接口写入数据</li>
</ul>
<p><strong>动态标签</strong></p>
<p>有些动态标签，例如需要根据用户出生日期动态计算用户年龄，根据在课日期动态计算在课天数。</p>
<p>处理方式：</p>
<ul>
<li>枚举不同场景的不同状态。</li>
<li>实时计算：将用户标签实时写入更新。</li>
<li>定时计算：定时全量更新用户标签。</li>
</ul>
<p><strong>群组能力</strong></p>
<p><strong>需要支持的能力：</strong></p>
<table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">具体内容</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">判断</td>
<td align="left">判断用户是否属于某个群组</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">查询</td>
<td align="left">根据用户群组找出所有用户根据用户群组查询总用户数</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>群组系统使用 HBase 存储用户的海量标签数据，使用 Solr 提供用户标签数据的个性化条件搜索能力。</p>
<p>用户群组是多个用户标签条件构成的规则，业务上通过群组能够实现用户圈选以及用户身份判别的能力，相关交互流程如下：</p>
<p><img src="/images/719.png" alt="图片2"></p>
<p><strong>基本方案</strong></p>
<p>判断用户是否属于某个群组：</p>
<ul>
<li>使用到了Antlr4，其作为一个词法、语法解析工具。</li>
<li>将用户标签与群组rule进行匹配，解析用户群组rule，将其转换为一个解析树，然后遍历解析树与用户标签进行对比。</li>
</ul>
<p>根据用户群组找出所有用户：</p>
<p>根据用户群组查询总用户数：</p>
<ul>
<li>HBase无法构建复杂的查询语句，因此需要使用solr或elasticsearch构建二级索引。</li>
<li>使用群组规则rule构建Bool查询语句，找出属于该群组的全部用户。</li>
</ul>
<p><strong>存储类型</strong></p>
<p>背景：</p>
<ul>
<li>标签系统标签值默认存储均为String类型，用户群组筛选用户时，取出的结果也全是string字符串。</li>
</ul>
<p>问题：</p>
<ul>
<li>一些需要排序的标签，会按照字典顺序排序，导致根据群组圈选用户的结果不准确</li>
<li>string类型排序性能较差</li>
</ul>
<p>改进：</p>
<ul>
<li>适当的对搜索引擎中的数据进行类型转化，明确标签的使用范围，实现群组检索的准确性，也避免标签值非法引起的业务转换问题。</li>
<li>每新增一个标签需要指定标签的存储类型，在solr中配置对应的后缀进行查询。</li>
</ul>
<p><strong>功能时序图</strong></p>
<p>采用hbase, mysql, solr存储：</p>
<ul>
<li>hbase: 存储用户标签信息，并将用户标签同步至solr<ul>
<li>hbase仅支持根据userid检索</li>
</ul>
</li>
<li>solr: 存储用户标签信息，支持根据标签索引</li>
<li>mysql: 存储用户群组信息、存储标签描述信息</li>
</ul>
<p><img src="/images/720.png" alt="图片4"></p>
<pre><code>@startuml
== 写入用户标签 ==
上游系统--&gt; EvaGroup:rpc/mq/job(电商/增长/数仓):用户标签
EvaGroup-&gt;:根据tag_meta_data过滤出需要写入的用户标签
EvaGroup-&gt; hbase: 存储用户标签
hbase-&gt;EvaGroup
EvaGroup-&gt;上游系统
hbase --&gt;solr: 同步用户标签
== 查询用户标签 ==
上游系统 -&gt; EvaGroup: userId
activate EvaGroup
EvaGroup -&gt; hbase: userId
hbase-&gt; EvaGroup: userTags
EvaGroup-&gt; 上游系统: userTags
deactivate EvaGroup
== 判断用户是否是某个群组 ==
上游系统-&gt;EvaGroup:userId,groupId
activate EvaGroup
EvaGroup-&gt;hbase: userId
hbase-&gt;EvaGroup:userTags
EvaGroup-&gt;mysql:groupId
mysql-&gt;EvaGroup:groupRules
EvaGroup-&gt;EvaGroup:判断userTags是否符合groupRules
EvaGroup-&gt;上游系统:true/false
deactivate EvaGroup
== 通过用户群组圈选用户 ==
上游系统-&gt;EvaGroup:groupId
activate EvaGroup
EvaGroup-&gt;mysql:groupId
mysql-&gt;EvaGroup:groupRules
EvaGroup-&gt;EvaGroup:将groupRules转为solr的查询条件
EvaGroup-&gt;solr:查询条件
solr-&gt;EvaGroup:查询结果
EvaGroup-&gt;EvaGroup:解析为用户id
EvaGroup-&gt;上游系统
deactivate EvaGroup
@enduml
</code></pre>
<p><strong>数据流转图</strong></p>
<img src="/images/721.png" alt="图片5" style="zoom:80%;" />

<p><strong>固定群组</strong></p>
<p>业务模型：</p>
<ul>
<li>创建群组时固定群组用户数据</li>
</ul>
<p>存储模型：</p>
<ul>
<li>存储介质：Solr</li>
<li>存储内容：groupId+userId</li>
</ul>
<p>数据处理流程：</p>
<p><img src="/images/722.png" alt="图片6"></p>
<p><strong>数据模型</strong></p>
<p><strong>MySQL</strong></p>
<p><strong>MySQL表设计：</strong></p>
<p>ER关系图：</p>
<p>用户标签的主题表，比如学期，购课类别，课程进度等。</p>
<pre><code class="sql">CREATE TABLE `tag_theme` (

  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;主键&#39;,

  `tagThemeDesc` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;标签主题描述&#39;,

  `tagTheme` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;标签主题&#39;,

  `status` tinyint(1) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;主题上下线状态 0 代表下线  1 代表上线 默认为0&#39;,

  `dbctime` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) COMMENT &#39;创建时间&#39;,

  `dbutime` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3) COMMENT &#39;更新时间&#39;,

  PRIMARY KEY (`id`)

) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci ROW_FORMAT=DYNAMIC COMMENT=&#39;标签主题表&#39;
</code></pre>
<p>用户标签元数据表，存储的标签信息配置表，其中包含不同的标签属性规则配置等。</p>
<pre><code class="sql">CREATE TABLE `tag_meta_data` (

  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;主键&#39;,

  `parentId` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;父标签id&#39;,

  `tagKey` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;标签key&#39;,

  `tagName` varchar(50) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;标签名称&#39;,

  `tagDesc` varchar(50) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;标签描述&#39;,

  `storeType` int NOT NULL DEFAULT &#39;1&#39; COMMENT &#39;存储值类型,1:string,2:int,2:long&#39;,

  `tagThemeId` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;标签主题表id&#39;,

  `effectiveTime` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;标签有效截止时间&#39;,

  `status` tinyint NOT NULL DEFAULT &#39;1&#39; COMMENT &#39;生效状态 0 为未生效 。1为已生效 默认为0&#39;,

  `hasChild` tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;是否包含子标签标志位 0 代表没有 1代表有 默认为0&#39;,

  `validatorRule` text COMMENT &#39;标签页面维护元数据规则&#39;,

  `updateFrequency` tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;标签值更新频率：0-默认（无标签值）；1-实时更新；2-每日更新；3-每周更新&#39;,

  `ldap` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT &#39;&#39; COMMENT &#39;创建人ldap&#39;,

  `dbctime` datetime(3) DEFAULT CURRENT_TIMESTAMP(3) COMMENT &#39;创建时间&#39;,

  `dbutime` datetime(3) DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3) COMMENT &#39;更新时间&#39;,

  PRIMARY KEY (`id`),

  UNIQUE KEY `uniq_tag_key` (`tagKey`),

  KEY `idx_parent_id` (`parentId`),

  KEY `idx_tag_theme` (`tagThemeId`)

) ENGINE=InnoDB AUTO_INCREMENT=36 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci ROW_FORMAT=DYNAMIC COMMENT=&#39;标签元数据表&#39;
</code></pre>
<p>用户群组表，将用户标签组合起来的规则。</p>
<pre><code class="sql">CREATE TABLE `group_info` (

  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;主键ID&#39;,

  `rule` text COMMENT &#39;群组规则&#39;,

  `groupName` varchar(256) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;用户群组名称&#39;,

  `groupDesc` varchar(256) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;用户群组描述&#39;,

  `locked` tinyint(1) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;是否锁定用户 0：否，1：是&#39;,

  `userCount` int DEFAULT &#39;0&#39; COMMENT &#39;群组人数&#39;,

  `type` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;群组类型&#39;,

  `channelType` int NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;渠道&#39;,

  `ldap` varchar(32) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ldap&#39;,

  `createTime` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;创建时间&#39;,

  `dbctime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;创建时间&#39;,

  `dbutime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#39;更新时间&#39;,

  PRIMARY KEY (`id`)

) ENGINE=InnoDB AUTO_INCREMENT=373 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci ROW_FORMAT=DYNAMIC COMMENT=&#39;群组信息&#39;
</code></pre>
<p>群组记录表，群组计算的记录表。</p>
<pre><code class="sql">CREATE TABLE `group_record` (

  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;主键ID&#39;,

  `groupId` bigint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;群组ID&#39;,

  `status` tinyint(1) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;0未开始1计算中2计算完成&#39;,

  `dbctime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;创建时间&#39;,

  `dbutime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#39;更新时间&#39;,

  PRIMARY KEY (`id`),

  UNIQUE KEY `uniq_groupId` (`groupId`)

) ENGINE=InnoDB AUTO_INCREMENT=18 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci ROW_FORMAT=DYNAMIC COMMENT=&#39;群组记录表&#39;
</code></pre>
<p><strong>HBase</strong></p>
<p>存储模型见：</p>
<p><strong>RowKey规范：</strong></p>
<p>对于不同的身份标识ID，在hbase标签库中的rowKey存储会有前缀的区别，具体的前缀以及列名可以参考如下枚举：</p>
<pre><code class="java">public enum UserIdentityEnum &#123;
    USER_ID(1, &quot;eva_user_id&quot;, &quot;user_id_&quot;, &quot;userId&quot;),
    UNION_ID(2, &quot;eva_union_id&quot;, &quot;union_id_&quot;, &quot;微信唯一标识ID&quot;),
    IDFV(3, &quot;eva_idfv&quot;, &quot;idfv_&quot;, &quot;IOS设备ID&quot;),
    OAID(4, &quot;eva_oaid&quot;, &quot;oaid_&quot;, &quot;安卓设备ID&quot;);
&#125;
</code></pre>
<p>第一列：标识具体的优先级，如userId的优先级会比unionId的优先级高，当两者绑定时，会将低优先级的行打上delete标签（软删除）。</p>
<p>第二列：”eva_user_id”标识hbase表中的列名，标识该标识ID具体存在hbase表中的列名。</p>
<p>第三列：”USERID_”标识该种类型身份标识作为rowKey时，具体对应的前缀，如userId为1234，对应的rowKey即为”user_id_1234”。</p>
<p>注：为了避免hbase标签热点问题，需要避免前缀过于相似，因此在写入数据时需要将rowkey数据进行逆序反转。</p>
<p><strong>Solr</strong></p>
<p><strong>索引列设计</strong></p>
<p>hbase增强版可以根据预先配置的json schema完成hbase标签 → solr查询索引列的映射。</p>
<p>在此过程中，solr索引列需要显示的指定具体的数据类型，如int，long，string，采用的方式为在标签名后加上指定的后缀。</p>
<ul>
<li>如_i表示该字段索引中存储为INT类型（hbase不为int则会尝试转换，否则会报错），_s表示该字段在索引中为STRING类型。</li>
</ul>
<p>此外，阿里云在识别标签名前缀为“attr_”时，会默认将该标签识别为数组类型，此时动态列配置可能不生效，因此，最终的solr索引列采用的方式为：前缀+标签key+动态列后缀</p>
<ul>
<li>如：base:attr_u_c_art_exp_break_date_v2 标签在hbase中列为：base:attr_u_c_art_exp_break_date_v2，数据存储格式为string。</li>
<li>同步到solr中则会将数据同步到 crm_attr_u_c_art_exp_break_date_v2_l 列中，solr中格式为long。</li>
</ul>
<p>注：一些非法数据在solr格式转换过程中可能会出错，会阻塞数据的同步，需要找阿里云修改一个配置参数，设置转换错误默认跳过，不阻塞其他数据的同步。</p>
<pre><code class="json">[
    &#123;
        &quot;source&quot;:&quot;base:attr_u_c_art_exp_break_date_v2&quot;,
        &quot;targetField&quot;:&quot;crm_attr_u_c_art_exp_break_date_v2_l&quot;,
        &quot;type&quot;:&quot;STRING&quot;
    &#125;,
    &#123;
        &quot;source&quot;:&quot;base:attr_u_c_art_exp_class_id_v2&quot;,
        &quot;targetField&quot;:&quot;crm_attr_u_c_art_exp_class_id_v2_s&quot;,
        &quot;type&quot;:&quot;STRING&quot;
    &#125;
]
</code></pre>
<p><strong>标签定义</strong></p>
<table>
<thead>
<tr>
<th align="left">一级分类</th>
<th align="left">二级分类</th>
<th align="left">三级分类</th>
<th align="left">四级分类（可无）</th>
<th align="left">标签描述</th>
<th align="left">标签定义</th>
<th align="left">条件</th>
<th align="left">更新频率</th>
<th align="left">数据来源</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">一级分类</td>
<td align="left">二级分类</td>
<td align="left">三级分类</td>
<td align="left">四级分类（可无）</td>
<td align="left">标签描述</td>
<td align="left">标签定义</td>
<td align="left">条件</td>
<td align="left">更新频率</td>
<td align="left">数据来源</td>
<td align="left">备注</td>
</tr>
<tr>
<td align="left">属性标签（attr）</td>
<td align="left">交易属性（deal）</td>
<td align="left">课程（course）</td>
<td align="left"></td>
<td align="left">未购课用户：无任意课程订单9元课用户：已购买SPUID为89的用户9元发声绘本用户：已购买SPUID为888的用户低价课用户：已购买SPUID为500的用户体验盒用户：已购买SPUID为527的用户1-3月龄礼盒用户：已购买SPUID为529的用户月龄盒用户：已购买SPUID为525的用户</td>
<td align="left">attr_deal_course</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">电商</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">9元课（nine_yuan_course)</td>
<td align="left">学期（semester）</td>
<td align="left">9元课课程对应的学期</td>
<td align="left">attr_deal_spuid89_semester</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程进度（progress）</td>
<td align="left">9元课课程对应的课程进度当前时间距开课后第几周</td>
<td align="left">attr_deal_spuid89_progress</td>
<td align="left">处于&#x2F;不处于</td>
<td align="left">每日</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程状态（status）</td>
<td align="left">9元课课程对应的课程状态</td>
<td align="left">attr_deal_spuid89_status</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">续报状态（transfer）</td>
<td align="left">9元课课程对应的续报状态</td>
<td align="left">attr_deal_spuid89_transfer</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">9元发声绘本（nine_yuan_audio)</td>
<td align="left">学期（semester）</td>
<td align="left">9元发声绘本课程对应的学期</td>
<td align="left">attr_deal_spuid888_semester</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程进度（progress）</td>
<td align="left">9元发声绘本课程对应的课程进度当前时间距开课后第几周</td>
<td align="left">attr_deal_spuid888_progress</td>
<td align="left">处于&#x2F;不处于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程状态（status）</td>
<td align="left">9元发声绘本课程对应的课程状态</td>
<td align="left">attr_deal_spuid888_status</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">续报状态（transfer）</td>
<td align="left">9元课课程对应的续报状态</td>
<td align="left">attr_deal_spuid888_transfer</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">低价课（low_price_course)</td>
<td align="left">学期（semester）</td>
<td align="left">低价课课程对应的学期</td>
<td align="left">attr_deal_spuid500_semester</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程进度（progress）</td>
<td align="left">低价课课程对应的课程进度当前时间距开课后第几周</td>
<td align="left">attr_deal_spuid500_progress</td>
<td align="left">处于&#x2F;不处于</td>
<td align="left">每日</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程状态（status）</td>
<td align="left">低价课课程对应的课程状态</td>
<td align="left">attr_deal_spuid500_status</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">续报状态（transfer）</td>
<td align="left">低价课课程对应的续报状态</td>
<td align="left">attr_deal_spuid500_transfer</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">体验盒（trial_course)</td>
<td align="left">学期（semester）</td>
<td align="left">体验盒课程对应的学期</td>
<td align="left">attr_deal_spuid527_semester</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程进度（progress）</td>
<td align="left">体验盒课程对应的课程进度当前时间距开课后第几周</td>
<td align="left">attr_deal_spuid527_progress</td>
<td align="left">处于&#x2F;不处于</td>
<td align="left">每日</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程状态（status）</td>
<td align="left">体验盒课程对应的课程状态</td>
<td align="left">attr_deal_spuid527_status</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">续报状态（transfer）</td>
<td align="left">体验盒课程对应的续报状态</td>
<td align="left">attr_deal_spuid527_transfer</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">月龄盒（system_course)</td>
<td align="left">学期（semester）</td>
<td align="left">月龄盒课程对应的学期</td>
<td align="left">attr_deal_spuid525_semester</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程进度（progress）</td>
<td align="left">月龄盒课程对应的课程进度在课用户最新发货月龄</td>
<td align="left">attr_deal_spuid525_progress</td>
<td align="left">处于&#x2F;不处于</td>
<td align="left">实时</td>
<td align="left">履约</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">课程状态（status）</td>
<td align="left">月龄盒课程对应的课程状态</td>
<td align="left">attr_deal_spuid525_status</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">续报状态（transfer）</td>
<td align="left">月龄盒课程对应的续报状态</td>
<td align="left">attr_deal_spuid525_transfer</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">辅导</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">用户属性（user）</td>
<td align="left">城市级别（city_level）</td>
<td align="left"></td>
<td align="left">取用户设置的收货地址中，对应城市所处的城市分级（需与商分侧定义一致）一线城市、新一线城市、二线城市、三线城市、四线城市、五线城市、未知</td>
<td align="left">attr_user_city_level</td>
<td align="left">属于&#x2F;不属于</td>
<td align="left">实时</td>
<td align="left">用户</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">月龄(month）</td>
<td align="left"></td>
<td align="left">录入数字，用户所填生日对应当前月龄</td>
<td align="left">attr_user_month</td>
<td align="left">小于、小于等于、等于、大于、大于等于</td>
<td align="left">实时</td>
<td align="left">用户</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<p><strong>常用标签规则</strong></p>
<p>假设用户存在以下标签数据：{“A”:”123”, “B”:”234”, “C”:”www”}</p>
<p>则在群组规则不同的时候存在以下结果：</p>
<pre><code>A = 123 → true

A != 123 → false

!(A=123) → false

A contain 123,125 → true

A contain 125 → false

A not_contain 234 → true

A not_contain 123 → false

D contain 321,322 → false

D not_contain 321,322 → true

exist A → true

exist D → false

not_exist A → false

not_exist D → true

A &gt; 100 → true

B &gt;= 300 → false

D &gt; 100 → false

D &lt;= 100 → false
</code></pre>
<p>注：群组规则存在一些缺陷，需要尽量按照常用的规则组合进行配置。</p>
<p><strong>标签规则详细说明</strong></p>
<p>leftExpr 连接符 rightExpr</p>
<p>用户群组的规则含有以下几类表达式：</p>
<p><strong>1. 或</strong></p>
<p>由关键词 | 分隔开左右两个表达式，为逻辑或的关系，只要满足其中一个条件，表达式结果为真。</p>
<p><strong>2. 与</strong></p>
<p>由关键词 &amp; 分隔开左右两个表达式，为逻辑与的关系，须要同时满足两个条件，表达式结果才为真。</p>
<p><strong>3. 等于</strong></p>
<p>由关键词 &#x3D; 分隔开左右两个表达式，左表达式只能为 string（用户标签的 key），根据右表达式的情况，含以下情况（优先级从高到低的顺序）：</p>
<ul>
<li>右表达式为字符串 valueStr：从用户的所有标签中取 key 为左表达式的标签值（如果不存在取出来的标签值为空，表达式结果为假），只有当取出来的值与 valueStr 相同时，表达式结果为真；否则为假。</li>
<li>右表达式为数字 valueNumber：从用户的所有标签中取 key 为左表达式的标签值（如果不存在取出来的标签值为空，表达式结果为假），只有当取出来的值与 valueNumber 相同时，表达式结果为真；否则为假。<ul>
<li>该情况下用户的标签中 key 为左表达式的标签值类型只能为整数，不然会报错</li>
</ul>
</li>
<li>其他情况：表达式结果为假</li>
</ul>
<p><strong>4. 不等于</strong></p>
<p>由关键词 !&#x3D; 分隔开的两个表达式，效果等效于“等于表达式”取反，涉及到用户可能不存在某个标签的情况，结果可能与直观感觉预期不一致：</p>
<ul>
<li>如果用户含有左表达式为 key 的标签值，则当右表达式与该标签值不相同的时候，表达式结果为真；否则为假。</li>
<li>如果用户不含有左表达式为 key 的标签值，则表达式结果为真；否则为假。</li>
<li>其他情况：表达式结果为真</li>
</ul>
<p><strong>5. 大于&#x2F;大于等于&#x2F;小于&#x2F;小于等于</strong></p>
<p>由关键词 &gt;、&gt;&#x3D;、&lt;、&lt;&#x3D; 分隔开的两个表达式，左表达式为用户的标签 key，右表达式为预期的标签值（可以为整数、小数）</p>
<ul>
<li>特殊地，如果用户不含有该 key 的标签，则表达式结果为假（即：用户不含某标签的话，使用 &gt;、&gt;&#x3D;、&lt;、&lt;&#x3D; 判断结果都为假）</li>
</ul>
<p><strong>6. 包含</strong></p>
<p>由关键词 contain 分隔开的两个表达式，左表达式为用户的标签 key，右表达式为英文逗号 , 分隔开的字符串（可以没有逗号，表示只有一个值）。语义为：在右表达式指定的值列表中，是否存在某个值与用户的标签值相同（标签key为左表达式）。</p>
<p><strong>7. 不包含</strong></p>
<p>由关键词 not_contain 分隔开的两个表达式，左表达式为用户的标签 key，右表达式为英文逗号 , 分隔开的字符串（可以没有逗号，表示只有一个值）。语义为：在右表达式指定的值列表中，如果存在某个值与用户的标签值相同（标签key为左表达式），则表达式结果为假；否则为真。（需要注意的是，如果用户不含有左表达式的标签 key，则整个不包含表达式的结果为真）</p>
<ol start="8">
<li><strong>取反</strong></li>
</ol>
<p>由 ! 及一个其它表达式组成，结果为原表达式取反。</p>
<p><strong>9. 存在&#x2F;不存在</strong></p>
<p>由 exist 或者 not_exist 及一个字符串 str 组成，用于检测用户的所有标签中是否存在&#x2F;不存在 key 为 str 的标签</p>
<p><strong>10. 括号表达式</strong></p>
<p>由括号 () 包裹的一组表达式作为一个整体，优先完成计算。</p>
<p><strong>常用操作</strong></p>
<pre><code>线上环境操作需要给机器加白名单：提工单

全局添加Hbase→Solr映射：

alter_external_index &#39;eva_user_tag&#39;, &#39;/Users/zhouyunpeng/Desktop/schema.json&#39;

查看Hbase→Solr映射：

describe_external_index &#39;eva_user_tag&#39;

添加Hbase→Solr映射字段：

add_external_index_field &#39;eva_user_tag&#39;, &#123;FAMILY =&gt; &#39;base&#39;, QUALIFIER =&gt; &#39;attr_user_group_test_0&#39;, TARGETFIELD =&gt; &#39;eva_attr_user_group_test_0_l&#39;, TYPE =&gt; &#39;STRING&#39; &#125;

删除HBase→Solr映射字段：
remove_external_index &#39;eva_user_tag&#39;, &#39;base:attr_user_group_test_0&#39;
</code></pre>
<p><strong>Anltr</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv19446094/">idea中 下载、安装、测试 Antlr4</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/JacksonKing/article/details/124033439">Antlr4简易快速入门</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hweinifengkuang/article/details/116334222">创建ANTLR4的maven项目</a></p>
<p>ANTLR（Another Tool for Language Recognition）是一种使用 Java 语言编写的，基于LL（<code>*</code>）算法实现的语法解析器生成器。ANTLR 可以用来设计一门语言，并且提供编程接口，实现该语言的语法解析功能。</p>
<p>一些应用：</p>
<p>Twitter搜索使用ANTLR进行语法分析，每天处理超过20亿次查询；<br>Lex Machine将ANTLR用于分析法律文本；<br>NetBeans公司的IDE使用ANTLR来解析C++；<br>Hibernate对象-关系映射框架（ORM）使用ANTLR来处理HQL语言。<br>……</p>
<p>e.g. </p>
<pre><code>Today is December 1st.

\&gt; T,o,d,a,y, ,i,s, ,D,e,c,e,m,b,e,r, ,1,s,t.
</code></pre>
<p>我们是无法仅从一个个单个的字符，去理解一句话完整的意思的，因为单个的字符并没有意义，一句话之所以有含义，是因为组成它的每一个单词具有意义。ANTLR 的语法分析过程与我们解读某句话意义的过程是相同的。</p>
<p><strong>ANTLR 语法分析过程</strong></p>
<p>首先进行词法分析，它是将字符聚集为单词或者符号的过程。</p>
<p>通过词法分析，ANTLR 根据事先定义的词法规则，将用户的输入字符解析为词法符号，并根据各个词法符号出现的位置，匹配语法规则，生成一颗上图所示的语法分析树。通过遍历 ANTLR 生成的语法分析树（ANTLR 提供了 Visitor 与 Listener 两种模式访问语法分析树），就能够根据我们自己的需求，实现自定义的语法功能。</p>
<p><strong>语法规则的定义</strong></p>
<pre><code>Grammar MyG ;
rule1: &lt;&lt;stuff&gt;&gt; ;
ule2: &lt;&lt;more stuff&gt;&gt; ;
Rule3: &lt;&lt;lecxical rule1&gt;&gt; ;
Rule4: &lt;&lt;lecxical rule2&gt;&gt; ;
</code></pre>
<ul>
<li>Grammer 声明语法规则的名称</li>
<li>大写字母开始的规则名称（Rule3、Rule4）声明词法规则</li>
<li>小写字母开始的规则名称（rule1、rule2）声明语法规则</li>
</ul>
<p>e.g.：</p>
<pre><code>grammar LabeledExpr; // rename to distinguish from Expr.g4
/** The start rule; begin parsing here. */
prog:   stat+ ;
 
stat:   expr NEWLINE                # printExpr
    |   ID &#39;=&#39; expr NEWLINE         # assign
    |   NEWLINE                     # blank
    ;
 
expr:   expr op=(&#39;*&#39;|&#39;/&#39;) expr      # MulDiv
    |   expr op=(&#39;+&#39;|&#39;-&#39;) expr      # AddSub
    |   INT                         # int
    |   ID                          # id
    |   &#39;(&#39; expr &#39;)&#39;                # parens
    ;
 
MUL :   &#39;*&#39; ; // assigns token name to &#39;*&#39; used above in grammar
DIV :   &#39;/&#39; ;
ADD :   &#39;+&#39; ;
SUB :   &#39;-&#39; ;
ID  :   [a-zA-Z]+ ;      // match identifiers
INT :   [0-9]+ ;         // match integers
NEWLINE:&#39;\r&#39;? &#39;\n&#39; ;     // return newlines to parser (is end-statement signal)
WS  :   [ \t]+ -&gt; skip ; // toss out whitespacegrammar Expr;
</code></pre>
<p>词法规则作为语法结构中的最小组成单位，它的解析是由ANTLR自动完成的，上层应用程序无法再控制词法规则具体的解析流程。</p>
<p>语法规则中，使用使用 # 标签标注语法，在 ANTLR 生成解析器的时候（使用 antlr -visitor 选项），就可以直接生成所标注语法规则的 visitor 接口，使用比较方便。</p>
<p><strong>计算器的例子</strong></p>
<pre><code>&gt; antlr4 -visitor -no-listener LabeledExpr.g4
&gt; javac *.java
&gt; grun LabeledExpr prog -gui
...
...
EOF(输入完成的标识)
</code></pre>
<p>编写 java 类，继承 ANLTR 生成的 LabeledExprVisitor 类，实现响应的语法解析代码，可以完成计算器的期望功能。</p>
<pre><code class="java">/***
 * Excerpted from &quot;The Definitive ANTLR 4 Reference&quot;,
 * published by The Pragmatic Bookshelf.
 * Copyrights apply to this code. It may not be used to create training material,
 * courses, books, articles, and the like. Contact us if you are in doubt.
 * We make no guarantees that this code is fit for any purpose.
 * Visit http://www.pragmaticprogrammer.com/titles/tpantlr2 for more book information.
***/
import java.util.HashMap;
import java.util.Map;
 
public class EvalVisitor extends LabeledExprBaseVisitor&lt;Integer&gt; &#123;
    /** &quot;memory&quot; for our calculator; variable/value pairs go here */
    Map&lt;String, Integer&gt; memory = new HashMap&lt;String, Integer&gt;();
 
    /** ID &#39;=&#39; expr NEWLINE */
    @Override
    public Integer visitAssign(LabeledExprParser.AssignContext ctx) &#123;
        String id = ctx.ID().getText();  // id is left-hand side of &#39;=&#39;
        int value = visit(ctx.expr());   // compute value of expression on right
        memory.put(id, value);           // store it in our memory
        return value;
    &#125;
 
    /** expr NEWLINE */
    @Override
    public Integer visitPrintExpr(LabeledExprParser.PrintExprContext ctx) &#123;
        Integer value = visit(ctx.expr()); // evaluate the expr child
        System.out.println(value);         // print the result
        return 0;                          // return dummy value
    &#125;
 
    /** INT */
    @Override
    public Integer visitInt(LabeledExprParser.IntContext ctx) &#123;
        return Integer.valueOf(ctx.INT().getText());
    &#125;
 
    /** ID */
    @Override
    public Integer visitId(LabeledExprParser.IdContext ctx) &#123;
        String id = ctx.ID().getText();
        if ( memory.containsKey(id) ) return memory.get(id);
        return 0;
    &#125;
 
    /** expr op=(&#39;*&#39;|&#39;/&#39;) expr */
    @Override
    public Integer visitMulDiv(LabeledExprParser.MulDivContext ctx) &#123;
        int left = visit(ctx.expr(0));  // get value of left subexpression
        int right = visit(ctx.expr(1)); // get value of right subexpression
        if ( ctx.op.getType() == LabeledExprParser.MUL ) return left * right;
        return left / right; // must be DIV
    &#125;
 
    /** expr op=(&#39;+&#39;|&#39;-&#39;) expr */
    @Override
    public Integer visitAddSub(LabeledExprParser.AddSubContext ctx) &#123;
        int left = visit(ctx.expr(0));  // get value of left subexpression
        int right = visit(ctx.expr(1)); // get value of right subexpression
        if ( ctx.op.getType() == LabeledExprParser.ADD ) return left + right;
        return left - right; // must be SUB
    &#125;
 
    /** &#39;(&#39; expr &#39;)&#39; */
    @Override
    public Integer visitParens(LabeledExprParser.ParensContext ctx) &#123;
        return visit(ctx.expr()); // return child expr&#39;s value
    &#125;
&#125;
</code></pre>
<p>计算器主函数：</p>
<pre><code class="java">/***
 * Excerpted from &quot;The Definitive ANTLR 4 Reference&quot;,
 * published by The Pragmatic Bookshelf.
 * Copyrights apply to this code. It may not be used to create training material,
 * courses, books, articles, and the like. Contact us if you are in doubt.
 * We make no guarantees that this code is fit for any purpose.
 * Visit http://www.pragmaticprogrammer.com/titles/tpantlr2 for more book information.
***/
import org.antlr.v4.runtime.*;
import org.antlr.v4.runtime.tree.ParseTree;
 
import java.io.FileInputStream;
import java.io.InputStream;
 
public class Calc &#123;
    public static void main(String[] args) throws Exception &#123;
        String inputFile = null;
        if ( args.length&gt;0 ) inputFile = args[0];
        InputStream is = System.in;
        if ( inputFile!=null ) is = new FileInputStream(inputFile);
        ANTLRInputStream input = new ANTLRInputStream(is);
        LabeledExprLexer lexer = new LabeledExprLexer(input);
        CommonTokenStream tokens = new CommonTokenStream(lexer);
        LabeledExprParser parser = new LabeledExprParser(tokens);
        ParseTree tree = parser.prog(); // parse
 
        EvalVisitor eval = new EvalVisitor();
        eval.visit(tree);
    &#125;
&#125;
</code></pre>
<p><strong>Solr</strong></p>
<p>管理HBase全文索引:<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/161129.html?spm=a2c4g.88401.0.0.754d715eRWfDiD">https://help.aliyun.com/document_detail/161129.html?spm=a2c4g.88401.0.0.754d715eRWfDiD</a></p>
<p>solr查询语法具体可参考：</p>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/754198?spm=a2c6h.12873639.article-detail.34.2ad89ffeESOTsm">https://developer.aliyun.com/article/754198?spm=a2c6h.12873639.article-detail.34.2ad89ffeESOTsm</a></p>
<p><a target="_blank" rel="noopener" href="https://solr.apache.org/guide/7_3/the-standard-query-parser.html?spm=a2c6h.12873639.article-detail.5.3e671c44Rg3TPc#differences-between-lucene-s-classic-query-parser-and-solr-s-standard-query-parser">https://solr.apache.org/guide/7_3/the-standard-query-parser.html?spm=a2c6h.12873639.article-detail.5.3e671c44Rg3TPc#differences-between-lucene-s-classic-query-parser-and-solr-s-standard-query-parser</a></p>
<p>solr的常用查询语法如下：</p>
<table>
<thead>
<tr>
<th align="left">操作符</th>
<th align="left">solr查询语法</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>==</code></td>
<td align="left"><code>field:value</code></td>
</tr>
<tr>
<td align="left"><code>!=</code></td>
<td align="left"><code>field:([* TO *] NOT value)</code></td>
</tr>
<tr>
<td align="left"><code>&gt;</code></td>
<td align="left"><code>field:&#123;value TO *&#125;</code></td>
</tr>
<tr>
<td align="left"><code>&gt;=</code></td>
<td align="left"><code>field:[value TO *]</code></td>
</tr>
<tr>
<td align="left"><code>&lt;</code></td>
<td align="left"><code>field:&#123;* TO value&#125;</code></td>
</tr>
<tr>
<td align="left"><code>&lt;=</code></td>
<td align="left"><code>field:[* TO value]</code></td>
</tr>
<tr>
<td align="left"><code>contain</code></td>
<td align="left"><code>field:(value1 value2 value3)</code></td>
</tr>
<tr>
<td align="left"><code>not_contain</code></td>
<td align="left"><code>filed:([* TO *] NOT (value1 value2))</code></td>
</tr>
<tr>
<td align="left"><code>exist</code></td>
<td align="left"><code>filed:[* TO *]</code></td>
</tr>
<tr>
<td align="left"><code>not_exist</code></td>
<td align="left"><code>-field:[* TO *]</code></td>
</tr>
</tbody></table>
<p>参考文档：</p>
<p><a target="_blank" rel="noopener" href="https://lucene.apache.org/core/3_5_0/queryparsersyntax.html">https://lucene.apache.org/core/3_5_0/queryparsersyntax.html</a></p>
<p><a target="_blank" rel="noopener" href="https://doc-archives.microstrategy.com/producthelp/10/WebUser/WebHelp/Lang_1033/searching_for_data_using_solr_search_syntax.htm">https://doc-archives.microstrategy.com/producthelp/10/WebUser/WebHelp/Lang_1033/searching_for_data_using_solr_search_syntax.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://solr.apache.org/guide/6_6/the-standard-query-parser.html#TheStandardQueryParser-BoostingaTermwith">https://solr.apache.org/guide/6_6/the-standard-query-parser.html#TheStandardQueryParser-BoostingaTermwith</a>_</p>
<p><a target="_blank" rel="noopener" href="https://blogs.library.duke.edu/bitstreams/2018/03/03/fun-solr-queries/">https://blogs.library.duke.edu/bitstreams/2018/03/03/fun-solr-queries/</a></p>
<p><a target="_blank" rel="noopener" href="http://www.solrtutorial.com/solr-query-syntax.html">http://www.solrtutorial.com/solr-query-syntax.html</a></p>
<pre><code>eva_attr_deal_spuid525_status_i:(2 3)

eva_attr_deal_spuid525_status_i:(2 OR 1 OR 3 OR 3 OR 4)

eva_attr_deal_course_s:(*527* *525*)
</code></pre>
<p><strong>HBase</strong></p>
<p>阿里云文档：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/88404.html?spm=a2c4g.11174283.6.579.22be3c2eV0T2cH">https://help.aliyun.com/document_detail/88404.html?spm=a2c4g.11174283.6.579.22be3c2eV0T2cH</a></p>
<p><strong>hbase shell安装</strong></p>
<p>打开集群地址<a target="_blank" rel="noopener" href="https://hbase.console.aliyun.com/hbase/cn-beijing/clusters%EF%BC%8C%E7%82%B9%E5%87%BB%E7%9B%B8%E5%BA%94%E9%9B%86%E7%BE%A4%EF%BC%8C%E5%9C%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E8%8F%9C%E5%8D%95%E6%A0%8F%E4%B8%8B%EF%BC%8C%E4%B8%8B%E8%BD%BDhbase">https://hbase.console.aliyun.com/hbase/cn-beijing/clusters，点击相应集群，在数据库连接菜单栏下，下载hbase</a> shell包。</p>
<p><img src="/images/723.png" alt="图片7"></p>
<p>下载之后本地解压，修改conf&#x2F;hbase-site.xml配置文件，具体配置可点击上图所示的一键生成配置项，并将生成的结果保存在配置项中。</p>
<p>随后在终端上，进入安装地址bin目录下，执行hbase shell命令，进入hbase管理终端。</p>
<p><strong>hbase shell使用</strong></p>
<p>hbase shell使用方法官方文档可参考<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/164447.html?spm=5176.21213303.J_6028563670.7.49cc3edaduarbc&scm=20140722.S_help@@%E6%96%87%E6%A1%A3@@164447.S_0.ID_164447-OR_s+helpproduct-V_1-P0_0">https://help.aliyun.com/document_detail&#x2F;164447.html?spm&#x3D;5176.21213303.J_6028563670.7.49cc3edaduarbc&amp;scm&#x3D;20140722.S_help%40%40%E6%96%87%E6%A1%A3%40%40164447.S_0.ID_164447-OR_s%2Bhelpproduct-V_1-P0_0</a></p>
<p><strong>常用命令</strong></p>
<p><strong>表定义命令</strong></p>
<table>
<thead>
<tr>
<th align="left">指令</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">create</td>
<td align="left">创建hbase表</td>
</tr>
<tr>
<td align="left">list</td>
<td align="left">列出所有的hbase表</td>
</tr>
<tr>
<td align="left">disable</td>
<td align="left">禁用表</td>
</tr>
<tr>
<td align="left">is_disabled</td>
<td align="left">验证表是否被禁用</td>
</tr>
<tr>
<td align="left">enable</td>
<td align="left">启用一个表</td>
</tr>
<tr>
<td align="left">is_enabled</td>
<td align="left">验证表是否被启用</td>
</tr>
<tr>
<td align="left">describe</td>
<td align="left">提供表的描述</td>
</tr>
<tr>
<td align="left">alter</td>
<td align="left">更改表结构</td>
</tr>
<tr>
<td align="left">exists</td>
<td align="left">验证表是否存在</td>
</tr>
<tr>
<td align="left">drop</td>
<td align="left">删除表</td>
</tr>
</tbody></table>
<p><strong>数据操作命令</strong></p>
<table>
<thead>
<tr>
<th align="left">指令</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">指令</td>
<td align="left">含义</td>
</tr>
<tr>
<td align="left">put</td>
<td align="left">插入数据</td>
</tr>
<tr>
<td align="left">get</td>
<td align="left">取一行或者某个单元格的内容</td>
</tr>
<tr>
<td align="left">delete</td>
<td align="left">删除表中的单元格值</td>
</tr>
<tr>
<td align="left">deleteall</td>
<td align="left">删除给定行的所有单元格</td>
</tr>
<tr>
<td align="left">scan</td>
<td align="left">扫描并返回表的数据</td>
</tr>
<tr>
<td align="left">count</td>
<td align="left">计算表行数</td>
</tr>
<tr>
<td align="left">truncate</td>
<td align="left">清空表数据，会丢失region分区</td>
</tr>
<tr>
<td align="left">truncate_preserve</td>
<td align="left">清空表数据，region分区保留原样</td>
</tr>
</tbody></table>
<p>常用命令如下：</p>
<p><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/6534.html">HBase put命令：插入数据</a></p>
<pre><code># 查看表
-&gt; list
 
# 创建一张表
-&gt;  create &#39;student&#39;,&#39;info&#39;
 
# 存储/更新数据
-&gt;  put &#39;student&#39;,&#39;1001&#39;,&#39;info:name&#39;,&#39;Thomas&#39;
 
# 查看存储的数据
-&gt;  scan &#39;student&#39;
 
# 查看表结构
-&gt;  describe ‘student’
 
# 查看指定行数据
-&gt;  get &#39;student&#39;,&#39;1001&#39;,&#39;info:name&#39;
 
# 删除某行数据
-&gt;  deleteall &#39;student&#39;,&#39;1001&#39;
 
# 删除某行的某一列数据
-&gt;  delete &#39;student&#39;,&#39;1001&#39;,&#39;info:sex&#39;
 
#清空表数据
-&gt;  truncate &#39;student&#39;
 
#删除表
-&gt;  disable &#39;student&#39;-&gt;  drop &#39;student&#39;
 
#删除指定列族
-&gt;  alter &#39;student&#39;, &#39;delete&#39; =&gt; &#39;info&#39;
或
-&gt;  alter &#39;student&#39;,&#123;NAME =&gt; &#39;info&#39;, METHOD =&gt; &#39;delete&#39;&#125;
</code></pre>
<p><strong>二级索引</strong></p>
<p>二级索引使用可参考：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/144577.html?spm=a2c4g.11186623.6.601.33a93070mpK3i7">https://help.aliyun.com/document_detail/144577.html?spm=a2c4g.11186623.6.601.33a93070mpK3i7</a></p>
<p>二级索引会创建一个以索引列为主键的表，若需要查询的列在索引列中不存在，则需要回查主表才能完成数据查询，因此，可以采用空间换时间的方式，将主表中的索引冗余在索引表中，避免再次回表查询。（类似于mysql的覆盖索引）</p>
<pre><code># 创建索引，索引列有2个，f1列族下的c2列，f2列族下的c3列。没有冗余列。
-&gt; create_index &#39;idx1&#39;, &#39;dt&#39;, &#123;INDEXED_COLUMNS =&gt; [&#39;f1:c2&#39;, &#39;f2:c3&#39;]&#125;
 
# 主表dt创建索引idx1，索引列有2个，f1列族下的c1列，冗余f2列族下的c2列。
-&gt; create_index &#39;idx2&#39;, &#39;dt&#39;, &#123;INDEXED_COLUMNS =&gt; [&#39;f1:c1&#39;]&#125;, &#123;COVERED_COLUMNS =&gt; [&#39;f2:c2&#39;]&#125;
 
# idx3会冗余dt的所有列
-&gt; create_index &#39;idx3&#39;, &#39;dt&#39;, &#123;INDEXED_COLUMNS =&gt; [&#39;f1:c3&#39;]&#125;, &#123;COVERED_COLUMNS =&gt; [&#39;COVERED_ALL_COLUMNS&#39;]&#125;
 
# 查看索引表schema
-&gt;  describe_index &#39;dt&#39;
 
# 删除索引schema
-&gt;  offline_index &#39;idx1&#39;, &#39;dt&#39;
-&gt;  remove_index &#39;idx1&#39;, &#39;dt&#39;
</code></pre>
<p>目前已有数据时，建立索引需要同步的将已有数据同步到索引表中，因此会比较耗时。</p>
<p><strong>全文索引</strong></p>
<p>全文索引文档可参考：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/215562.html?spm=a2c4g.11186623.6.685.1a292c4eYvJSeX">https://help.aliyun.com/document_detail/215562.html?spm=a2c4g.11186623.6.685.1a292c4eYvJSeX</a></p>
<p>配置全文索引成功依赖于hbase增强版关联BDS集群（要求BDS不被其他业务使用），随后购买开通全文索引。</p>
<p><strong>全文索引关联demo</strong></p>
<p>数据同步流主要为hbase-&gt;BDS-&gt;solr，我们需要建立hbase-&gt;solr的索引schema映射，从而能够实现数据的导入。</p>
<pre><code># shell 创建一个名为testTable，列族为f的表
create &#39;testTable&#39;, &#123;NAME =&gt; &#39;f&#39;&#125;
</code></pre>
<p>配置solr索引可参考：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/161121.html?spm=a2c4g.11186623.6.689.41386935S7kHhk">https://help.aliyun.com/document_detail/161121.html?spm=a2c4g.11186623.6.689.41386935S7kHhk</a></p>
<p>随后在本地新建一个schema.json文件维护映射关系：</p>
<pre><code>&#123;
  &quot;sourceNamespace&quot;: &quot;default&quot;,
  &quot;sourceTable&quot;: &quot;testTable&quot;,
  &quot;targetIndexName&quot;: &quot;democollection&quot;,
  &quot;indexType&quot;: &quot;SOLR&quot;,
  &quot;rowkeyFormatterType&quot;: &quot;STRING&quot;,
  &quot;fields&quot;: [
    &#123;
      &quot;source&quot;: &quot;f:name&quot;,
      &quot;targetField&quot;: &quot;name_s&quot;,
      &quot;type&quot;: &quot;STRING&quot;
    &#125;
  ]
&#125;
</code></pre>
<p>保存之后，在shell中运行脚本：</p>
<p>线上环境进入生产机器执行，需要开白名单</p>
<pre><code># shell 建立索引映射关系
alter_external_index &#39;testTable&#39;, &#39;/Users/huangxin/Tools/alihbase-2.0.18/schema.json&#39;
</code></pre>
<p>建立之后，hbase对应列的相关数据就可以同步到solr搜索实例中。</p>
<p>可以在solr中查询同步的数据：</p>
<p><img src="/images/724.png" alt="图片8"></p>
<p>检索的结果中id即为hbase中的rowkey，可以根据rowkey查询具体的标签数据。</p>
<p><strong>hbase与solr索引映射</strong></p>
<p>配置集的更新可以参考：<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/174724.html?spm=a2c4g.11186623.6.757.37e147262VqhaG">https://help.aliyun.com/document_detail/174724.html?spm=a2c4g.11186623.6.757.37e147262VqhaG</a></p>
<p>映射关系的存储采用json方式实现，映射配置的一些字段说明如下：</p>
<table>
<thead>
<tr>
<th align="left">名称</th>
<th align="left"></th>
<th align="left">释义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">sourceNamespace</td>
<td align="left"></td>
<td align="left">hbase表的nameSpace，默认为default</td>
</tr>
<tr>
<td align="left">sourceTable</td>
<td align="left"></td>
<td align="left">hbase表的表名</td>
</tr>
<tr>
<td align="left">targetIndexName</td>
<td align="left"></td>
<td align="left">solr的索引名称</td>
</tr>
<tr>
<td align="left">indexType</td>
<td align="left"></td>
<td align="left">索引类型，固定为SOLR</td>
</tr>
<tr>
<td align="left">rowkeyFormatterType</td>
<td align="left"></td>
<td align="left">hbase中rowkey的格式，此处可以填<code>STRING</code>或者<code>HEX``string: rowKey为string类型</code>hex: rowKey不为string类型</td>
</tr>
<tr>
<td align="left">fields</td>
<td align="left"></td>
<td align="left">映射的列以及相关类型</td>
</tr>
<tr>
<td align="left">source</td>
<td align="left">hbase表的列名，列族+列名</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">targetField</td>
<td align="left">solr索引表的列名，列名可以为动态列</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">索引列配置的类型，可以为INT，LONG，STRING，BOOLEAN，FLOAT，DOUBLE，SHORT，BIGDECEMAL等类型，需注意大小写敏感。</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>若想在原有schema的基础上修改若干列，可以采用add_external_index_field只添加对应列的映射。</p>
<pre><code># shell 添加若干列映射
add_external_index_field &#39;testTable&#39;, &#123;FAMILY =&gt; &#39;f&#39;, QUALIFIER =&gt; &#39;money&#39;, TARGETFIELD =&gt; &#39;money_f&#39;, TYPE =&gt; &#39;FLOAT&#39; &#125;
# shell 删除若干列映射
remove_external_index &#39;testTable&#39;, &#39;f:name&#39;, f:age&#39;
</code></pre>
<p>查看现有的映射关系：</p>
<pre><code># shell 查看现有映射
describe_external_index &#39;testTable&#39;
</code></pre>
<p>配置完映射之后，新生成的数据会自动同步到solr索引中，但是hbase表中的存量数据，需要手工执行异步全量构建操作方可完成数据的同步。</p>
<pre><code># shell 全量同步
build_external_index &#39;testTable&#39;
# shell 取消全量同步
cancel_build_external_index &#39;testTable&#39;
</code></pre>
<p><strong>功能模块</strong></p>
<p><img src="/images/725.png" alt="图片9"></p>
<p><strong>数据举例</strong></p>
<p>validatorRule（元数据表：tag_meta_data）:</p>
<pre><code>&#123;&quot;inputType&quot;:&quot;multiOption&quot;,&quot;canSelectedLabels&quot;:[&#123;&quot;label&quot;:&quot;9元课用户&quot;,&quot;value&quot;:&quot;89&quot;&#125;,&#123;&quot;label&quot;:&quot;9元发声绘本用户&quot;,&quot;value&quot;:&quot;888&quot;&#125;,&#123;&quot;label&quot;:&quot;低价课用户&quot;,&quot;value&quot;:&quot;500&quot;&#125;,&#123;&quot;label&quot;:&quot;体验盒用户&quot;,&quot;value&quot;:&quot;527&quot;&#125;,&#123;&quot;label&quot;:&quot;1-3月龄礼盒用户&quot;,&quot;value&quot;:&quot;529&quot;&#125;,&#123;&quot;label&quot;:&quot;月龄盒用户&quot;,&quot;value&quot;:&quot;525&quot;&#125;],&quot;inputValueLabels&quot;:[&#123;&quot;label&quot;:&quot;9元课用户&quot;,&quot;value&quot;:&quot;89&quot;&#125;,&#123;&quot;label&quot;:&quot;9元发声绘本用户&quot;,&quot;value&quot;:&quot;888&quot;&#125;,&#123;&quot;label&quot;:&quot;低价课用户&quot;,&quot;value&quot;:&quot;500&quot;&#125;,&#123;&quot;label&quot;:&quot;体验盒用户&quot;,&quot;value&quot;:&quot;527&quot;&#125;,&#123;&quot;label&quot;:&quot;1-3月龄礼盒用户&quot;,&quot;value&quot;:&quot;529&quot;&#125;,&#123;&quot;label&quot;:&quot;月龄盒用户&quot;,&quot;value&quot;:&quot;525&quot;&#125;],&quot;inputValue&quot;:null,&quot;optionListLabels&quot;:[&#123;&quot;label&quot;:&quot;属于&quot;,&quot;value&quot;:&quot;contain&quot;&#125;,&#123;&quot;label&quot;:&quot;不属于&quot;,&quot;value&quot;:&quot;not_contain&quot;&#125;],&quot;suggestType&quot;:null&#125;	
</code></pre>
<pre><code>&#123;&quot;inputType&quot;:&quot;weekInput&quot;,&quot;canSelectedLabels&quot;:[],&quot;inputValueLabels&quot;:[],&quot;inputValue&quot;:null,&quot;optionListLabels&quot;:[&#123;&quot;label&quot;:&quot;处于&quot;,&quot;value&quot;:&quot;between&quot;&#125;,&#123;&quot;label&quot;:&quot;不处于&quot;,&quot;value&quot;:&quot;not_between&quot;&#125;],&quot;suggestType&quot;:null&#125;	
</code></pre>
<pre><code>&#123;&quot;inputType&quot;:&quot;monthInput&quot;,&quot;canSelectedLabels&quot;:[],&quot;inputValueLabels&quot;:[],&quot;inputValue&quot;:null,&quot;optionListLabels&quot;:[&#123;&quot;label&quot;:&quot;处于&quot;,&quot;value&quot;:&quot;between&quot;&#125;,&#123;&quot;label&quot;:&quot;不处于&quot;,&quot;value&quot;:&quot;not_between&quot;&#125;],&quot;suggestType&quot;:null&#125;
</code></pre>
<pre><code>&#123;&quot;inputType&quot;:&quot;numberInput&quot;,&quot;optionListLabels&quot;:[&#123;&quot;label&quot;:&quot;大于&quot;,&quot;value&quot;:&quot;&gt;&quot;&#125;,&#123;&quot;label&quot;:&quot;大于等于&quot;,&quot;value&quot;:&quot;&gt;=&quot;&#125;,&#123;&quot;label&quot;:&quot;等于&quot;,&quot;value&quot;:&quot;=&quot;&#125;,&#123;&quot;label&quot;:&quot;小于&quot;,&quot;value&quot;:&quot;&lt;&quot;&#125;,&#123;&quot;label&quot;:&quot;小于等于&quot;,&quot;value&quot;:&quot;&lt;=&quot;&#125;]&#125;	
</code></pre>

	</div>
	<!--打赏-->
        <div class="reward">
       <div class="reward-button">赏 <span class="reward-code">
        <span class="alipay-code"> <img class="alipay-img wdp-appear" src="/alipay.png"><b>支付宝打赏</b> </span> 
        <span class="wechat-code"> <img class="wechat-img wdp-appear" src="/weipay.jpeg"><b>微信打赏</b> </span> 
       </div>
      <p class="reward-notice">如果文章对你有帮助，欢迎点击上方按钮打赏作者！</p>
      </div>
      <!--打赏-->
</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/HBase%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  HBase最佳实践
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7/">
                相关工具
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>






<script>

    //document.oncontextmenu=new Function("event.returnValue=false");
	//document.onselectstart=new Function("event.returnValue=false");

	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?7eeb54583579fabc0878be210d6ad60a";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();

	

	$(function () {
		const btw = new BTWPlugin();
	    btw.init({
	        id: 'container',
	        blogId: '22377-1713171226726-221',
	        name: '月伴飞鱼',
	        qrcode: '/小程序码.jpg',
	        keyword: '验证码',
	        btnText: '为防止机器刷接口，需要完成人机检测',
        	cookieAge: 1
	    });

	    var contents = document.getElementsByClassName("content999");
	    //监听文章内容的copy事件
	    contents[0].addEventListener('copy',function(e){
	        setClipboardText(e);
	    });

	    function setClipboardText(event){
	        // clipboardData 对象是为通过编辑菜单、快捷菜单和快捷键执行的编辑操作所保留的，也就是你复制或者剪切内容
	        let clipboardData = event.clipboardData || window.clipboardData;

	        // 如果未复制或者未剪切，则return出去
	        if (!clipboardData) { return; }

	        event.preventDefault();

	        // Selection 对象，表示用户选择的文本范围或光标的当前位置。
	        // 声明一个变量接收 -- 用户输入的剪切或者复制的文本转化为字符串
	        let text = window.getSelection().toString();
	    
	        if (text) {
	            // 如果文本存在则先取消文本默认事件
	            event.preventDefault();
	            // 通过调用常clipboardData对象的 setData(format, data) 方法；来设置相关文本
	            // format: 一个DOMString 表示要添加到 drag object的拖动数据的类型。
	            // data: 一个 DOMString表示要添加到 drag object的数据。
	            var copyright = '\n\n'
	            + '\n著作权归作者所有。'
	            + '\n商业转载请联系作者获得授权，非商业转载请注明出处。'
	            + '\n作者: 月伴飞鱼'
	            + '\n原文地址: http://hardyfish.top/2024/05/20/%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%85%B3/%E7%BE%A4%E7%BB%84%E7%B3%BB%E7%BB%9F/'
	    
	            clipboardData.setData('text/plain', text + copyright);
	    
	        }
	    };
	});

	
</script>

<script>
    const btw = new BTWPlugin();
    btw.init({
        id: 'container',
        blogId: '22377-1713171226726-221',
        name: '月伴飞鱼',
        qrcode: '/小程序码.jpg',
        keyword: '验证码',
        btnText: '为防止机器刷接口，需要完成人机检测',
        cookieAge: 1
    });

	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?7eeb54583579fabc0878be210d6ad60a";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">月伴飞鱼</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			PV 180986
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			UV 10079
		</span>
	
	<br>
	微信搜索 <a href="https://xiaoflyfish.oss-cn-beijing.aliyuncs.com/image/个人公众号.jpg" target="_blank">月伴飞鱼</a> 关注我
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>