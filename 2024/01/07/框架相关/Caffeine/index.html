<!DOCTYPE html>
<html lang="en" oncontextmenu="return false;">

<head oncontextmenu="return false;">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="baidu-site-verification" content="codeva-QodU0Nk5F7" />
	<meta name="google-site-verification" content="DbSTw8OJwtH5Qei7n8Jnew0YyQ5naPzdLAPiscu7zQE" />
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">

	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?7eeb54583579fabc0878be210d6ad60a";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>

	
	<!-- title -->
	
	<title>
	
		Caffeine | 
	 
	月伴飞鱼
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/%E5%A4%B4%E5%83%8F.jpg">
	
  
  	
<link rel="stylesheet" href="/css/main.css">

  	
<link rel="stylesheet" href="/css/reward.css">

	
<link rel="stylesheet" href="/css/jquery.fancybox.min.css">

	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="/lib/highlight/darcula.css">

	
<link rel="stylesheet" href="/css/clipboard-use.css">


	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>


	
<script src="/lib/highlight/highlight.min.js"></script>


	
<script src="https://readmore.openwrite.cn/js/readmore-2.0.js"></script>

	
<script src="/lib/jquery-3.4.1.min.js"></script>

	
<script src="/lib/jquery.pjax.js"></script>


	
<script src="/js/main.js"></script>

	
<script src="/js/jquery.fancybox.min.js"></script>

	
		
<script src="/lib/valine/av-3.0.4-min.js"></script>

		
<script src="/lib/valine/Valine-1.3.10-min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
	
<script src="/js/clipboard.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body oncontextmenu="return false;">
	<header id="header" oncontextmenu="return false;">
    <a id="title" href="/" class="logo">公众号月伴飞鱼</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">关于我</a>
		</li>

		<li class="menu-item">
			<a href="/个人微信.jpeg" class="menu-item-link">联系作者</a>
		</li>

	    <li class="menu-item">
			<a href="/site" class="menu-item-link">关于网站</a>
		</li>

		<li class="menu-item">
			<a href="/个人公众号.jpg" class="menu-item-link" target="_blank">我的公众号</a>
		</li>
		
		<li class="menu-item">
			<a href="https://tech.meituan.com/" class="menu-item-link" target="_blank">
				美团技术团队
			</a>
		</li>
		<li class="menu-item">
			<a href="https://tech.youzan.com/" class="menu-item-link" target="_blank">
				有赞技术团队
			</a>
		</li>
		<!--<li class="menu-item">
			<select class="menu-item-link menu-item-select">
				<option class="menu-item-link"  value="volvo">Volvo</option>
				<option class="menu-item-link"  value="saab">Saab</option>
				<option class="menu-item-link"  value="fiat">Fiat</option>
				<option class="menu-item-link"  value="audi">Audi</option>
			</select>
		</li>-->
	</ul>
</header>

	<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="text" placeholder="按目录搜索一下">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										AI相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/01/14/AI%E7%9B%B8%E5%85%B3/AIGC/">
										AIGC
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										中间件
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/30/%E4%B8%AD%E9%97%B4%E4%BB%B6/Dubbo/">
										Dubbo
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/19/%E4%B8%AD%E9%97%B4%E4%BB%B6/Elasticsearch/">
										Elasticsearch
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/30/%E4%B8%AD%E9%97%B4%E4%BB%B6/Netty/">
										Netty
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/25/%E4%B8%AD%E9%97%B4%E4%BB%B6/Solr/">
										Solr
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/19/%E4%B8%AD%E9%97%B4%E4%BB%B6/ZooKeeper/">
										ZooKeeper
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										代码思想
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/15/%E4%BB%A3%E7%A0%81%E6%80%9D%E6%83%B3/CodeReview/">
										CodeReview
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E4%BB%A3%E7%A0%81%E6%80%9D%E6%83%B3/%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/">
										代码重构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										前端相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/CSS/">
										CSS
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/12/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">
										小程序
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										基础知识
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/11/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Go%E5%9F%BA%E7%A1%80/">
										Go基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/27/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/JVM/">
										JVM
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/21/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Java%E5%9F%BA%E7%A1%80/">
										Java基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/29/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Python%E5%9F%BA%E7%A1%80/">
										Python基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%88%86%E5%B8%83%E5%BC%8F/">
										分布式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/10/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">
										并发编程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
										设计模式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										大数据相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/01/25/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Doris/">
										Doris
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/20/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Flink/">
										Flink
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/07/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Hive/">
										Hive
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/20/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/Spark/">
										Spark
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习专栏
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E4%BB%A3%E7%A0%81%E4%B9%8B%E4%B8%91/">
										代码之丑
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E5%A4%A7%E5%8E%82%E6%99%8B%E5%8D%87%E6%8C%87%E5%8D%97/">
										大厂晋升指南
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习书籍
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/02/05/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/HBase%E4%B8%8D%E7%9D%A1%E8%A7%89%E4%B9%A6/">
										HBase不睡觉书
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/02/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">
										Java并发编程实战
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/02/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%9A%84%E8%89%BA%E6%9C%AF/">
										Java并发编程的艺术
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/16/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/">
										Java开发手册
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/05/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/">
										代码整洁之道
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										工具相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Arthas/">
										Arthas
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/24/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/ChatGPT/">
										ChatGPT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/21/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/GIT/">
										GIT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/21/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Hexo/">
										Hexo
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/21/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/MAC/">
										MAC
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/01/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Maven/">
										Maven
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/09/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/PlantUML/">
										PlantUML
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/22/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/UTools/">
										UTools
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/">
										实用工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										成长相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/">
										技术学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/07/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92/">
										读书计划
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E9%9D%A2%E8%AF%95%E7%9B%B8%E5%85%B3/">
										面试相关
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										数据库
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/27/%E6%95%B0%E6%8D%AE%E5%BA%93/HBase/">
										HBase
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E6%95%B0%E6%8D%AE%E5%BA%93/MongoDB/">
										MongoDB
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/02/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/">
										MySQL
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/21/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/">
										Redis
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										服务器
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%9C%8D%E5%8A%A1%E5%99%A8/Docker/">
										Docker
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E6%9C%8D%E5%8A%A1%E5%99%A8/Nginx/">
										Nginx
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/03/%E6%9C%8D%E5%8A%A1%E5%99%A8/Tomcat/">
										Tomcat
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E8%BF%90%E7%BB%B4%E7%9F%A5%E8%AF%86/">
										运维知识
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										架构相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/21/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/DDD/">
										DDD
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E6%9E%B6%E6%9E%84%E5%9B%BE/">
										架构图
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0/">
										架构学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E4%BF%9D%E9%9A%9C/">
										系统保障
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD/">
										系统性能
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">
										系统设计
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										框架相关
									</a>
									
							<ul>
								<li class="file active">
									<a href="/2024/01/07/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Caffeine/">
										Caffeine
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/06/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Guava/">
										Guava
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/15/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/JWT/">
										JWT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/MyBatis/">
										MyBatis
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/14/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/RPC%E6%A1%86%E6%9E%B6/">
										RPC框架
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/26/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Seata/">
										Seata
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/02/03/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/ShardingSphere/">
										ShardingSphere
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/14/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Spring/">
										Spring
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/03/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Thrift/">
										Thrift
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/29/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/XXLJOB/">
										XXLJOB
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
										开源框架
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										消息队列
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/KAFKA/">
										KAFKA
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/20/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RabbitMQ/">
										RabbitMQ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RocketMQ/">
										RocketMQ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										源码相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/13/%E6%BA%90%E7%A0%81%E7%9B%B8%E5%85%B3/RocketMQ/">
										RocketMQ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										生活相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/27/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E4%B9%A6%E7%B1%8D/">
										书籍
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/17/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E5%81%9A%E8%8F%9C/">
										做菜
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E7%94%B5%E5%BD%B1/">
										电影
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/10/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E7%94%B5%E8%A7%86%E5%89%A7/">
										电视剧
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/01/11/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E7%BA%AA%E5%BD%95%E7%89%87/">
										纪录片
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E7%94%9F%E6%B4%BB%E7%9B%B8%E5%85%B3/%E9%9F%B3%E4%B9%90/">
										音乐
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										算法相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/11/26/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/LeetCode/">
										LeetCode
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/26/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/%E5%89%91%E6%8C%87OFFER/">
										剑指OFFER
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/25/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/%E9%9D%A2%E8%AF%95%E7%AE%97%E6%B3%95/">
										面试算法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										系统相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E4%BB%BB%E5%8A%A1%E7%B3%BB%E7%BB%9F/">
										任务系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/18/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E5%B9%BF%E5%91%8A%E7%B3%BB%E7%BB%9F/">
										广告系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E6%89%93%E8%BD%A6%E7%B3%BB%E7%BB%9F/">
										打车系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/18/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/">
										推荐系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E7%94%A8%E6%88%B7%E7%B3%BB%E7%BB%9F/">
										用户系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E7%9B%B4%E6%92%AD%E7%B3%BB%E7%BB%9F/">
										直播系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E7%9F%AD%E9%93%BE%E7%B3%BB%E7%BB%9F/">
										短链系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E7%A4%BE%E5%8C%BA%E7%B3%BB%E7%BB%9F/">
										社区系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/">
										秒杀系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/19/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E7%BA%A2%E5%8C%85%E7%B3%BB%E7%BB%9F/">
										红包系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/18/%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/%E8%AE%A2%E5%8D%95%E7%B3%BB%E7%BB%9F/">
										订单系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										英语相关
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										老友记
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%B8%80%E5%AD%A3/">
										第一季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%B8%89%E5%AD%A3/">
										第三季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/23/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%BA%94%E5%AD%A3/">
										第五季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/17/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%8B%B1%E8%AF%AD%E8%AF%AD%E6%B3%95/">
										英语语法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										雅思
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/01/25/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E9%9B%85%E6%80%9D/%E5%89%91%E6%A1%A5%E9%9B%85%E6%80%9D%E5%90%AC%E5%8A%9B%E7%9C%9F%E9%A2%9815/">
										剑桥雅思听力真题15
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/12/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E9%9B%85%E6%80%9D/%E5%89%91%E6%A1%A5%E9%9B%85%E6%80%9D%E5%90%AC%E5%8A%9B%E7%9C%9F%E9%A2%984/">
										剑桥雅思听力真题4
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										计算机基础
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
										操作系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
										数据结构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86/">
										算法知识
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/19/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">
										网络基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title" oncontextmenu="return false;">

	Caffeine
</h1>
<div class="article-meta" oncontextmenu="return false;">
	<span>月伴飞鱼</span>
	<span>2024-01-07 13:17:53</span>
    
		<div id="article-categories">
            
                
                    <span>
                        <i class="fa fa-folder" aria-hidden="true"></i>
                        <a href="/categories/框架相关/">框架相关</a>
						
                    </span>
                
            
		</div>
    
</div>

<div id="container" class = "content999" oncontextmenu="return false;">
<!--打赏-->
        <div class="reward">
       <div class="reward-button">赏 <span class="reward-code">
        <span class="alipay-code"> <img class="alipay-img wdp-appear" src="/alipay.png"><b>支付宝打赏</b> </span> 
        <span class="wechat-code"> <img class="wechat-img wdp-appear" src="/weipay.jpeg"><b>微信打赏</b> </span> 
       </div>
      <p class="reward-notice">如果文章对你有帮助，欢迎点击上方按钮打赏作者！</p>
      </div>
      <!--打赏-->
	<div id="article-content">
		<blockquote>
<p>相较于Guava Cache，<code>Caffeine</code>在整体设计理念、实现策略以及接口定义等方面都基本继承了前辈的优秀特性。</p>
<p>作为新时代背景下的后来者，Caffeine做了很多细节层面的优化，比如：</p>
<ul>
<li><strong>基础数据结构层面优化</strong> 借助JAVA8对<code>ConcurrentHashMap</code>底层由链表切换为<strong>红黑树</strong>、以及<strong>废弃分段锁</strong>逻辑的优化，提升了Hash冲突时的查询效率以及并发场景下的处理性能。</li>
<li><strong>数据驱逐（淘汰）策略的优化</strong> 通过使用改良后的<code>W-TinyLFU</code>算法，提供了更佳的热点数据留存效果，提供了<strong>近乎完美</strong>的热点数据<code>命中率</code>，以及更低消耗的过程维护。</li>
<li><strong>异步并行能力的全面支持</strong> 完美适配<code>JAVA8</code>之后的<strong>并行编程</strong>场景，可以提供更为优雅的并行编码体验与并发效率。</li>
</ul>
</blockquote>
<p><strong>容器创建</strong></p>
<pre><code class="java">Cache&lt;Integer, String&gt; cache = Caffeine.newBuilder().build();
</code></pre>
<table>
<thead>
<tr>
<th>方法</th>
<th>含义说明</th>
</tr>
</thead>
<tbody><tr>
<td>build()</td>
<td>构建一个手动回源的Cache对象</td>
</tr>
<tr>
<td>build(CacheLoader)</td>
<td>构建一个支持使用给定CacheLoader对象进行自动回源操作的LoadingCache对象</td>
</tr>
<tr>
<td>buildAsync()</td>
<td>构建一个支持异步操作的异步缓存对象</td>
</tr>
<tr>
<td>buildAsync(CacheLoader)</td>
<td>使用给定的CacheLoader对象构建一个支持异步操作的缓存对象</td>
</tr>
<tr>
<td>buildAsync(AsyncCacheLoader)</td>
<td>与buildAsync(CacheLoader)相似，区别点仅在于传入的参数类型不一样。</td>
</tr>
</tbody></table>
<blockquote>
<p>为了便于<strong>异步场景</strong>中处理，可以通过<code>buildAsync()</code>构建一个手动回源数据加载的缓存对象：</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) &#123;
    AsyncCache&lt;String, User&gt; asyncCache = Caffeine.newBuilder()
    .buildAsync();
    User user = asyncCache.get(&quot;123&quot;, s -&gt; &#123;
        System.out.println(&quot;异步callable thread:&quot; + Thread.currentThread().getId());
        return userDao.getUser(s);
    &#125;).join();
&#125;
</code></pre>
<blockquote>
<p>为了支持异步场景中的自动异步回源，可以通过<code>buildAsync(CacheLoader)</code>或者<code>buildAsync(AsyncCacheLoader)</code>来实现：</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) throws Exception&#123;
    AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache =
            Caffeine.newBuilder().maximumSize(1000L).buildAsync(key -&gt; userDao.getUser(key));
    User user = asyncLoadingCache.get(&quot;123&quot;).join();
&#125;
</code></pre>
<blockquote>
<p>在创建缓存对象的同时，可以指定此缓存对象的一些处理策略，比如容量限制、比如过期策略等等。</p>
</blockquote>
<table>
<thead>
<tr>
<th>方法</th>
<th>含义说明</th>
</tr>
</thead>
<tbody><tr>
<td>initialCapacity</td>
<td>待创建的缓存容器的初始容量大小（记录<strong>条数</strong>）</td>
</tr>
<tr>
<td>maximumSize</td>
<td>指定此缓存容器的最大容量(最大缓存记录<strong>条数</strong>)</td>
</tr>
<tr>
<td>maximumWeight</td>
<td>指定此缓存容器的最大容量（最大<strong>比重</strong>值），需结合<code>weighter</code>方可体现出效果</td>
</tr>
<tr>
<td>expireAfterWrite</td>
<td>设定过期策略，按照数据<strong>写入时间</strong>进行计算</td>
</tr>
<tr>
<td>expireAfterAccess</td>
<td>设定过期策略，按照数据最后<strong>访问时间</strong>来计算</td>
</tr>
<tr>
<td>expireAfter</td>
<td>基于<strong>个性化定制</strong>的逻辑来实现过期处理（可以定制基于<code>新增</code>、<code>读取</code>、<code>更新</code>等场景的过期策略，甚至支持为<em>不同记录指定不同过期时间</em>）</td>
</tr>
<tr>
<td>weighter</td>
<td>入参为一个函数式接口，用于指定每条存入的缓存数据的权重占比情况。这个需要与<code>maximumWeight</code>结合使用</td>
</tr>
<tr>
<td>refreshAfterWrite</td>
<td>缓存写入到缓存之后</td>
</tr>
<tr>
<td>recordStats</td>
<td>设定开启此容器的数据加载与缓存命中情况统计</td>
</tr>
</tbody></table>
<pre><code class="java">public static void main(String[] args) &#123;
    AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache = CaffeinenewBuilder()
            .initialCapacity(1000) // 指定初始容量
            .maximumSize(10000L) // 指定最大容量
            .expireAfterWrite(30L, TimeUnit.MINUTES) // 指定写入30分钟后过期
            .refreshAfterWrite(1L, TimeUnit.MINUTES) // 指定每隔1分钟刷新下数据内容
            .removalListener((key, value, cause) -&gt;
                    System.out.println(key + &quot;移除，原因：&quot; + cause)) // 监听记录移除事件
            .recordStats() // 开启缓存操作数据统计
            .buildAsync(key -&gt; userDao.getUser(key)); // 构建异步CacheLoader加载类型的缓存对象
&#125;
</code></pre>
<p><strong>缓存操作</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>含义说明</th>
</tr>
</thead>
<tbody><tr>
<td>get</td>
<td>根据key获取指定的缓存值，如果没有则执行<strong>回源</strong>操作获取</td>
</tr>
<tr>
<td>getAll</td>
<td>根据给定的key列表批量获取对应的缓存值，返回一个<code>map格式</code>的结果，没有命中缓存的部分会执行<strong>回源</strong>操作获取</td>
</tr>
<tr>
<td>getIfPresent</td>
<td><strong>不执行回源</strong>操作，直接从缓存中尝试获取key对应的缓存值</td>
</tr>
<tr>
<td>getAllPresent</td>
<td><strong>不执行回源</strong>操作，直接从缓存中尝试获取给定的key列表对应的值，返回查询到的map格式结果， <em>异步场景不支持</em>此方法</td>
</tr>
<tr>
<td>put</td>
<td>向缓存中写入指定的key与value记录</td>
</tr>
<tr>
<td>putAll</td>
<td>批量向缓存中写入指定的key-value记录集，<em>异步场景不支持</em>此方法</td>
</tr>
<tr>
<td>asMap</td>
<td>将缓存中的数据转换为map格式返回</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>同步</strong>缓存:</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) throws Exception &#123;
    LoadingCache&lt;String, String&gt; loadingCache = buildLoadingCache();
    loadingCache.put(&quot;key1&quot;, &quot;value1&quot;);
    String value = loadingCache.get(&quot;key1&quot;);
    System.out.println(value);
&#125;
</code></pre>
<blockquote>
<p><strong>异步</strong>缓存：</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) throws Exception &#123;
    AsyncLoadingCache&lt;String, String&gt; asyncLoadingCache = buildAsyncLoadingCache();
    // 写入缓存记录（value值为异步获取）
    asyncLoadingCache.put(&quot;key1&quot;, CompletableFuture.supplyAsync(() -&gt; &quot;value1&quot;));
    // 异步方式获取缓存值
    CompletableFuture&lt;String&gt; completableFuture = asyncLoadingCache.get(&quot;key1&quot;);
    String value = completableFuture.join();
    System.out.println(value);
&#125;
</code></pre>
<p><strong>异步策略</strong></p>
<blockquote>
<p><code>Caffeine</code>采用了<strong>异步处理</strong>的策略，<code>get</code>请求中虽然也会触发淘汰数据的清理操作，但是将清理任务添加到了独立的线程池中进行异步的<strong>不会阻塞</strong> <code>get</code> 请求的执行与返回，这样大大缩短了<code>get</code>请求的执行时长，提升了响应性能。</p>
<p>除了对自身的异步处理优化，Caffeine还提供了全套的<code>Async</code>异步处理机制，可以支持业务在异步并行流水线式处理场景中使用以获得更加丝滑的体验。</p>
<p>Caffeine完美的支持了在异步场景下的<strong>流水线</strong>处理使用场景，回源操作也支持<strong>异步</strong>的方式来完成。</p>
<p><code>CompletableFuture</code>并行流水线能力，是<code>JAVA8</code>在<strong>异步编程</strong>领域的一个重大改进。</p>
<p>可以将一系列耗时且无依赖的操作改为并行同步处理，并等待各自处理结果完成后继续进行后续环节的处理，由此来降低阻塞等待时间，进而达到降低请求链路时长的效果。</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) throws Exception &#123;
    AsyncLoadingCache&lt;String, String&gt; asyncLoadingCache = buildAsyncLoadingCache();
    // 写入缓存记录（value值为异步获取）
    asyncLoadingCache.put(&quot;key1&quot;, CompletableFuture.supplyAsync(() -&gt; &quot;value1&quot;));
    // 异步方式获取缓存值
    CompletableFuture&lt;String&gt; completableFuture = asyncLoadingCache.get(&quot;key1&quot;);
    String value = completableFuture.join();
    System.out.println(value);
&#125;
</code></pre>
<p><strong>淘汰算法</strong></p>
<table>
<thead>
<tr>
<th>算法</th>
<th>弊端说明</th>
</tr>
</thead>
<tbody><tr>
<td>FIFO</td>
<td><code>先进先出</code>策略，属于一种最为简单与原始的策略。如果缓存使用频率较高，会导致缓存数据<strong>始终在不停的进进出出</strong>，影响性能，且命中率表现也一般。</td>
</tr>
<tr>
<td>LRU</td>
<td><code>最近最久未使用</code>策略，保留最近被访问到的数据，而淘汰最久没有被访问的数据。如果遇到偶尔的批量刷数据情况，<strong>很容易将其他缓存内容都挤出内存</strong>，带来缓存击穿的风险。</td>
</tr>
<tr>
<td>LFU</td>
<td><code>最近少频率</code>策略，这种根据访问次数进行淘汰，相比而言内存中存储的热点数据命中率会更高些，缺点就是<strong>需要维护独立字段</strong>用来记录每个元素的访问次数，占用内存空间。</td>
</tr>
</tbody></table>
<blockquote>
<p>为了保证命中率，一般缓存框架都会选择使用LRU或者LFU策略，很少会有使用FIFO策略进行数据淘汰的。</p>
<p>Caffeine缓存的LFU采用了<code>Count-Min Sketch</code>频率统计算法，由于该LFU的计数器只有<code>4bit</code>大小，所以称为<strong>TinyLFU</strong>。</p>
<p>在TinyLFU算法基础上引入一个基于LRU的<code>Window Cache</code>，这个新的算法叫就叫做<strong>W-TinyLFU</strong>。</p>
<p><code>W-TinyLFU</code>算法有效的解决了LRU以及LFU存在的弊端，为Caffeine提供了大部分场景下<strong>近乎完美</strong>的<strong>命中率</strong>表现。</p>
</blockquote>
<p><strong>异步淘汰清理机制</strong></p>
<blockquote>
<p><code>Caffeine</code>为了提升读写操作的并发效率而将数据淘汰清理操作改为了<strong>异步处理</strong>，而异步处理时会有微小的延时。</p>
<p>不管是基于大小、还是基于过期时间或基于引用的数据淘汰策略，由于数据淘汰处理是异步进行的，都会存在<strong>短暂</strong>的<strong>不够精确</strong>的情况。</p>
</blockquote>
<p><strong>数据驱逐机制</strong></p>
<p>基于时间:</p>
<blockquote>
<p>Caffine支持<strong>基于时间</strong>进行数据的淘汰驱逐处理。</p>
<p>这部分的能力与Guava Cache相同，支持根据记录<strong>创建时间</strong>以及<strong>访问时间</strong>两个维度进行处理。</p>
<p>数据的过期时间在创建缓存对象的时候进行指定，Caffeine在创建缓存对象的时候提供了<code>3种</code>设定过期策略的方法。</p>
</blockquote>
<table>
<thead>
<tr>
<th>方式</th>
<th>具体说明</th>
</tr>
</thead>
<tbody><tr>
<td>expireAfterWrite</td>
<td>基于创建时间进行过期处理</td>
</tr>
<tr>
<td>expireAfterAccess</td>
<td>基于最后访问时间进行过期处理</td>
</tr>
<tr>
<td>expireAfter</td>
<td>基于<strong>个性化定制</strong>的逻辑来实现过期处理（可以定制基于<code>新增</code>、<code>读取</code>、<code>更新</code>等场景的过期策略，甚至支持为不同记录指定不同过期时间）</td>
</tr>
</tbody></table>
<blockquote>
<p>expireAfterWrite:<code>expireAfterWrite</code>用于指定数据创建之后多久会过期。</p>
<p>当记录被写入缓存之后达到指定的时间之后，就会被过期淘汰（<strong>惰性删除</strong>，并不会立即从内存中移除，而是在下一次操作的时候触发清理操作）。</p>
</blockquote>
<pre><code class="java">Cache&lt;String, User&gt; userCache = 
    Caffeine.newBuilder()
        .expireAfterWrite(1, TimeUnit.SECONDS)
        .build();
userCache.put(&quot;123&quot;, new User(&quot;123&quot;, &quot;张三&quot;))；
</code></pre>
<blockquote>
<p>expireAfterAccess<code>：expireAfterAccess</code>用于指定缓存记录多久没有被访问之后就会过期。</p>
<p>这种是基于最后一次访问时间来计算数据是否过期，如果一个数据一直被访问，则其就不会过期。</p>
<ul>
<li>比较适用于<strong>热点数据</strong>的存储场景，可以保证较高的缓存命中率。</li>
</ul>
<p>同样地，数据过期时也不会被立即从内存中移除，而是基于<strong>惰性删除</strong>机制进行处理。</p>
</blockquote>
<pre><code class="java">Cache&lt;String, User&gt; userCache = 
    Caffeine.newBuilder()
        .expireAfterAccess(1, TimeUnit.SECONDS)
        .build();
    userCache.get(&quot;123&quot;, s -&gt; userDao.getUser(s));
</code></pre>
<blockquote>
<p>expireAfter:其支持传入一个自定义的<code>Expiry</code>对象，自行实现数据的过期策略，甚至是针对不同的记录来定制不同的过期时间。</p>
<p>Expiry接口中需要实现的三个方法：</p>
</blockquote>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>含义说明</th>
</tr>
</thead>
<tbody><tr>
<td>expireAfterCreate</td>
<td>指定一个过期时间，从记录创建的时候开始计时，超过指定的时间之后就过期淘汰，效果类似<code>expireAfterWrite</code>，但是支持<strong>更灵活</strong>的定制逻辑。</td>
</tr>
<tr>
<td>expireAfterUpdate</td>
<td>指定一个过期时间，从记录最后一次被更新的时候开始计时，超过指定的时间之后就过期。每次执行<strong>更新操作</strong>之后，都会重新计算过期时间。</td>
</tr>
<tr>
<td>expireAfterRead</td>
<td>指定一个过期时间，从记录最后一次被访问的时候开始计时，超过指定时间之后就过期。效果类似<code>expireAfterAccess</code>，但是支持<strong>更高级</strong>的定制逻辑。</td>
</tr>
</tbody></table>
<blockquote>
<p>比如下面的代码中，定制了<code>expireAfterCreate</code>方法的逻辑，根据缓存key来决定过期时间，如果key以字母A开头则设定1s过期，否则设定2s过期：</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) &#123;
    try &#123;
        LoadingCache&lt;String, User&gt; userCache = Caffeine.newBuilder()
                .removalListener((key, value, cause) -&gt; &#123;
                    System.out.println(key + &quot;移除，原因：&quot; + cause);
                &#125;)
                .expireAfter(new Expiry&lt;String, User&gt;() &#123;
                    @Override
                    public long expireAfterCreate(@NonNull String key, @NonNullUser value, long currentTime) &#123;
                        if (key.startsWith(&quot;A&quot;)) &#123;
                            return TimeUnit.SECONDS.toNanos(1);
                        &#125; else &#123;
                            return TimeUnit.SECONDS.toNanos(2);
                        &#125;
                    &#125;
                    @Override
                    public long expireAfterUpdate(@NonNull String key, @NonNullUser value, long currentTime,
                                                  @NonNegative longcurrentDuration) &#123;
                        return Long.MAX_VALUE;
                    &#125;
                    @Override
                    public long expireAfterRead(@NonNull String key, @NonNull Uservalue, long currentTime,
                                                @NonNegative long currentDuration)&#123;
                        return Long.MAX_VALUE;
                    &#125;
                &#125;)
                .build(key -&gt; userDao.getUser(key));
        userCache.put(&quot;123&quot;, new User(&quot;123&quot;, &quot;123&quot;));
        userCache.put(&quot;A123&quot;, new User(&quot;A123&quot;, &quot;A123&quot;));
        Thread.sleep(1100L);
        System.out.println(userCache.get(&quot;123&quot;));
        System.out.println(userCache.get(&quot;A123&quot;));
    &#125; catch (Exception e) &#123;
        e.printStackTrace();
    &#125;
&#125;
</code></pre>
<blockquote>
<p>除了根据<code>key</code>来定制不同的过期时间，也可以根据<code>value</code>的内容来指定不同的过期时间策略。</p>
<p>也可以同时定制上述三个方法，搭配来实现更复杂的过期策略。</p>
<p>按照这种方式来定时过期时间的时候需要注意一点，如果不需要设定某一维度的过期策略的时候，需要将对应实现方法的返回值设置为一个非常大的数值，比如可以像上述示例代码中一样，指定为<code>Long.MAX_VALUE</code>值。</p>
</blockquote>
<p>基于大小:</p>
<blockquote>
<p>Caffeine支持针对缓存<strong>总体容量</strong>大小进行限制，如果容量满的时候，基于<code>W-TinyLFU</code>算法，淘汰最不常被使用的数据，腾出空间给新的记录写入。</p>
<p>Caffeine支持按照<code>Size</code>（记录条数）或者按照W<code>eighter</code>（记录权重）值进行总体容量的限制。</p>
</blockquote>
<blockquote>
<p>maximumSize：在创建Caffeine缓存对象的时候，可以通过<code>maximumSize</code>来指定允许缓存的最大条数。</p>
</blockquote>
<pre><code class="java">Cache&lt;Integer, String&gt; cache = Caffeine.newBuilder()
        .maximumSize(1000L) // 限制最大缓存条数
        .build();
</code></pre>
<blockquote>
<p>maximumWeight：在创建Caffeine缓存对象的时候，可以通过<code>maximumWeight</code>与<code>weighter</code>组合的方式，指定按照权重进行限制缓存总容量。</p>
<p>比如一个字符串value值的缓存场景下，可以根据字符串的长度来计算权重值，最后根据总权重大小来限制容量。</p>
</blockquote>
<pre><code class="java">Cache&lt;Integer, String&gt; cache = Caffeine.newBuilder()
        .maximumWeight(1000L) // 限制最大权重值
        .weigher((key, value) -&gt; (String.valueOf(value).length() / 1000) + 1)
        .build();
</code></pre>
<blockquote>
<p><strong>使用注意点:</strong></p>
<p>如果创建的时候指定了<code>weighter</code>，则必须同时指定<code>maximumWeight</code>值，如果不指定、或者指定了maximumSize，会<strong>报错</strong>（这一点与Guava Cache一致）。</p>
</blockquote>
<p>基于引用：</p>
<blockquote>
<p>基于引用回收的策略，核心是利用<code>JVM</code>虚拟机的<strong>GC机制</strong>来达到数据清理的目的。</p>
<p>当一个对象不再被引用的时候，JVM会选择在适当的时候将其回收。</p>
<p>Caffeine支持<code>三种</code>不同的基于引用的回收方法。</p>
</blockquote>
<table>
<thead>
<tr>
<th>方法</th>
<th>具体说明</th>
</tr>
</thead>
<tbody><tr>
<td>weakKeys</td>
<td>采用<code>弱引用</code>方式存储key值内容，当key对象不再被引用的时候，由<strong>GC</strong>进行回收</td>
</tr>
<tr>
<td>weakValues</td>
<td>采用<code>弱引用</code>方式存储value值内容，当value对象不再被引用的时候，由<strong>GC</strong>进行回收</td>
</tr>
<tr>
<td>softValues</td>
<td>采用<code>软引用</code>方式存储value值内容，当内存容量满时基于<strong>LRU</strong>策略进行回收</td>
</tr>
</tbody></table>
<blockquote>
<p>weakKeys：默认情况下，创建出一个Caffeine缓存对象并写入<code>key-value</code>映射数据时，key和value都是以<strong>强引用</strong>的方式存储的。</p>
<p>而使用<code>weakKeys</code>可以指定将缓存中的key值以<strong>弱引用</strong>（WeakReference）的方式进行存储，这样一来，如果程序运行时没有其它地方使用或者依赖此缓存值的时候，该条记录就可能会被<code>GC回收</code>掉。</p>
</blockquote>
<pre><code class="java"> LoadingCache&lt;String,  User&gt; loadingCache = Caffeine.newBuilder()
                .weakKeys()
                .build(key -&gt; userDao.getUser(key));
</code></pre>
<blockquote>
<p>weakValues:与weakKeys类似，可以在创建缓存对象的时候使用<code>weakValues</code>指定将value值以<strong>弱引用</strong>的方式存储到缓存中。</p>
<p>这样当这条缓存记录的对象不再被引用依赖的时候，就会被JVM在适当的时候回收释放掉。</p>
</blockquote>
<pre><code class="java"> LoadingCache&lt;String,  User&gt; loadingCache = Caffeine.newBuilder()
                .weakValues()
                .build(key -&gt; userDao.getUser(key));
</code></pre>
<blockquote>
<p>softValues<code>：softValues</code>是指将缓存内容值以<strong>软引用</strong>的方式存储在缓存容器中，当<strong>内存容量满</strong>的时候Caffeine会以<code>LRU</code>（least-recently-used，最近最少使用）顺序进行数据淘汰回收。</p>
</blockquote>
<table>
<thead>
<tr>
<th>方式</th>
<th>具体描述</th>
</tr>
</thead>
<tbody><tr>
<td>weakValues</td>
<td><strong>弱引用</strong>方式存储，一旦不再被引用，则会被GC回收</td>
</tr>
<tr>
<td>softValues</td>
<td><strong>软引用</strong>方式存储，不会被GC回收，但是在内存容量满的时候，会基于<strong>LRU策略</strong>数据回收</td>
</tr>
</tbody></table>
<blockquote>
<p>具体使用的时候，可以在创建缓存对象的时候进行指定基于软引用方式数据淘汰。</p>
</blockquote>
<pre><code class="java"> LoadingCache&lt;String,  User&gt; loadingCache = Caffeine.newBuilder()
                .softValues()
                .build(key -&gt; userDao.getUser(key));
</code></pre>
<p><strong>同步数据回源</strong></p>
<blockquote>
<p>查询缓存、数据回源、数据回填缓存、返回执行结果等一系列操作都是在一个调用线程中<strong>同步阻塞</strong>完成的。</p>
</blockquote>
<p><strong>Callable方式回源</strong></p>
<blockquote>
<p>在每次<code>get</code>请求的时候，传入一个Callable函数式接口具体实现，当没有命中缓存的时候，Caffeine框架会执行给定的Callable实现逻辑，去获取真实的数据并且回填到缓存中，然后返回给调用方。</p>
<p><strong><code>Callable</code>方式的回源填充：</strong></p>
<p>会带来一个<strong>问题</strong>，就是如果需要获取缓存的地方太多，会导致每个调用的地方都得指定下对应Callable回源方法，调用起来比较<strong>麻烦</strong>，且对于需要保证回源逻辑统一的场景管控能力不够强势，无法约束所有的调用方使用相同的回源逻辑。</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) &#123;
    Cache&lt;String, User&gt; cache = Caffeine.newBuilder().build();
    User user = cache.get(&quot;123&quot;, s -&gt; userDao.getUser(s));
    System.out.println(user);
&#125;
</code></pre>
<p><strong>CacheLoader回源</strong></p>
<blockquote>
<p>在创建缓存对象的时候，可以通在<code>build()</code>方法中传入指定的<strong>CacheLoader</strong>对象的方式来指定回源时默认使用的回源数据加载器，这样当使用方调用<code>get</code>方法获取不到数据的时候，框架就会自动使用给定的<strong>CacheLoader</strong>对象执行对应的数据加载逻辑。</p>
</blockquote>
<blockquote>
<p>比如下面的代码中，便在创建缓存对象时指定了当缓存未命中时通过<code>userDao.getUser()</code>方法去DB中执行数据查询操作：</p>
</blockquote>
<pre><code class="java">public LoadingCache&lt;String, User&gt; createUserCache() &#123;
    return Caffeine.newBuilder()
            .maximumSize(10000L)
            .build(key -&gt; userDao.getUser(key));
&#125;
</code></pre>
<blockquote>
<p>CacheLoader更<strong>适用</strong>于所有回源场景使用的回源策略都固定且统一的情况。</p>
<p>对具体业务使用的时候更加的友好，调用<code>get</code>方法也更加简单，只需要传入带查询的<code>key</code>值即可。</p>
</blockquote>
<p><strong>不回源</strong></p>
<table>
<thead>
<tr>
<th>接口</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>getIfPresent</td>
<td>从内存中查询，如果存在则返回对应值，不存在则返回null</td>
</tr>
<tr>
<td>getAllPresent</td>
<td>批量从内存中查询，如果存在则返回存在的键值对，不存在的key则不出现在结果集里</td>
</tr>
</tbody></table>
<pre><code class="java">public static void main(String[] args) &#123;
    LoadingCache&lt;String, User&gt; cache = Caffeine.newBuilder().build(userId -&gt; userDao.getUser(userId));
    cache.put(&quot;124&quot;, new User(&quot;124&quot;, &quot;张三&quot;));
    User userInfo = cache.getIfPresent(&quot;123&quot;);
    System.out.println(userInfo);
    Map&lt;String, User&gt; presentUsers =
            cache.getAllPresent(Stream.of(&quot;123&quot;, &quot;124&quot;, &quot;125&quot;).collect(Collectors.toList()));
    System.out.println(presentUsers);
&#125;
</code></pre>
<p><strong>异步Callable</strong></p>
<blockquote>
<p>要想支持异步场景下使用缓存，则创建的时候必须要创建一个异步缓存类型，可以通过<code>buildAsync()</code>方法来构建一个<strong>AsyncCache</strong>类型缓存对象，进而可以在异步场景下进行使用。</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) &#123;
    AsyncCache&lt;String, User&gt; asyncCache = Caffeine.newBuilder().buildAsyn();
    CompletableFuture&lt;User&gt; userCompletableFuture = asyncCache.get(&quot;123&quot;, s -&gt; userDao.getUser(s));
    System.out.println(userCompletableFuture.join());
&#125;
</code></pre>
<blockquote>
<p>get方法传入了Callable回源逻辑，然后会开始<strong>异步</strong>的加载处理操作，并返回了个CompletableFuture类型结果，最后如果需要获取其实际结果的时候，需要等待其异步执行完成然后获取到最终结果（通过上述代码中的<code>join()</code>方法等待并获取结果）。</p>
</blockquote>
<p><strong>异步CacheLoader</strong></p>
<blockquote>
<p>异步处理的时候，Caffeine也支持直接在创建的时候指定CacheLoader对象，然后生成支持异步回源操作的<code>AsyncLoadingCache</code>缓存对象，然后在使用<code>get</code>方法获取结果的时候，也是返回的<code>CompletableFuture</code>异步封装类型，满足在异步编程场景下的使用。</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) &#123;
    try &#123;
        AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache =
                Caffeine.newBuilder().maximumSize(1000L).buildAsync(key -&gt; userDao.getUser(key));
        CompletableFuture&lt;User&gt; userCompletableFuture = asyncLoadingCache.get(&quot;123&quot;);
        System.out.println(userCompletableFuture.join());
    &#125; catch (Exception e) &#123;
        e.printStackTrace();
    &#125;
&#125;
</code></pre>
<p><strong>异步AsyncCacheLoader</strong></p>
<blockquote>
<p>在创建的时候给定一个用于回源处理的CacheLoader之外，Caffeine还有一个<code>buildAsync</code>的重载版本，允许传入一个同样是支持异步并行处理的<code>AsyncCacheLoader</code>对象。</p>
</blockquote>
<pre><code class="java">public static void main(String[] args) &#123;
    try &#123;
        AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache =
                Caffeine.newBuilder().maximumSize(1000L).buildAsync(
                        (key, executor) -&gt; CompletableFuture.supplyAsync(() -&gt; userDao.getUser(key), executor)
                );
        CompletableFuture&lt;User&gt; userCompletableFuture = asyncLoadingCache.get(&quot;123&quot;);
        System.out.println(userCompletableFuture.join());
    &#125; catch (Exception e) &#123;
        e.printStackTrace();
    &#125;
&#125;
</code></pre>

	</div>
</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/2024/01/07/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  读书计划
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2024/01/06/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Guava/">
                Guava
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>




<script>

    //document.oncontextmenu=new Function("event.returnValue=false");
	//document.onselectstart=new Function("event.returnValue=false");

	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?7eeb54583579fabc0878be210d6ad60a";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();

	

	$(function () {
		const btw = new BTWPlugin();
	    btw.init({
	        id: 'container',
	        blogId: '22377-1706525467336-300',
	        name: '月伴飞鱼',
	        qrcode: '/小程序码.jpg',
	        keyword: '验证码',
	        btnText: '为防止机器刷接口，需要完成人机检测',
        	cookieAge: 1
	    });

	    var contents = document.getElementsByClassName("content999");
	    //监听文章内容的copy事件
	    contents[0].addEventListener('copy',function(e){
	        setClipboardText(e);
	    });

	    function setClipboardText(event){
	        // clipboardData 对象是为通过编辑菜单、快捷菜单和快捷键执行的编辑操作所保留的，也就是你复制或者剪切内容
	        let clipboardData = event.clipboardData || window.clipboardData;

	        // 如果未复制或者未剪切，则return出去
	        if (!clipboardData) { return; }

	        event.preventDefault();

	        // Selection 对象，表示用户选择的文本范围或光标的当前位置。
	        // 声明一个变量接收 -- 用户输入的剪切或者复制的文本转化为字符串
	        let text = window.getSelection().toString();
	    
	        if (text) {
	            // 如果文本存在则先取消文本默认事件
	            event.preventDefault();
	            // 通过调用常clipboardData对象的 setData(format, data) 方法；来设置相关文本
	            // format: 一个DOMString 表示要添加到 drag object的拖动数据的类型。
	            // data: 一个 DOMString表示要添加到 drag object的数据。
	            var copyright = '\n\n'
	            + '\n著作权归作者所有。'
	            + '\n商业转载请联系作者获得授权，非商业转载请注明出处。'
	            + '\n作者: 月伴飞鱼'
	            + '\n原文地址: http://hardyfish.top/2024/01/07/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Caffeine/'
	    
	            clipboardData.setData('text/plain', text + copyright);
	    
	        }
	    };
	});

	
</script>

<script>
    const btw = new BTWPlugin();
    btw.init({
        id: 'container',
        blogId: '22377-1706525467336-300',
        name: '月伴飞鱼',
        qrcode: '/小程序码.jpg',
        keyword: '验证码',
        btnText: '为防止机器刷接口，需要完成人机检测',
        cookieAge: 1
    });

	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?7eeb54583579fabc0878be210d6ad60a";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">月伴飞鱼</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			PV 180986
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			UV 10079
		</span>
	
	<br>
	微信搜索 <a href="https://xiaoflyfish.oss-cn-beijing.aliyuncs.com/image/个人公众号.jpg" target="_blank">月伴飞鱼</a> 关注我
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>