<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		Elasticsearch | 
	 
	月伴飞鱼
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/%E5%A4%B4%E5%83%8F.jpg">
	
  
  	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="/css/jquery.fancybox.min.css">

	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="/lib/highlight/darcula.css">

	
<link rel="stylesheet" href="/css/clipboard-use.css">


	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">

	
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>


	
<script src="/lib/highlight/highlight.min.js"></script>

	
<script src="https://readmore.openwrite.cn/js/readmore.js"></script>

	
<script src="/lib/jquery-3.4.1.min.js"></script>

	
<script src="/lib/jquery.pjax.js"></script>


	
<script src="/js/main.js"></script>

	
<script src="/js/jquery.fancybox.min.js"></script>

	
		
<script src="/lib/valine/av-3.0.4-min.js"></script>

		
<script src="/lib/valine/Valine-1.3.10-min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
	
<script src="/js/clipboard.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body oncontextmenu="return false;">
	<header id="header">
    <a id="title" href="/" class="logo">公众号月伴飞鱼</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">关于我</a>
		</li>

	    <li class="menu-item">
			<a href="/site" class="menu-item-link">关于网站</a>
		</li>

		<li class="menu-item">
			<a href="/个人公众号.jpg" class="menu-item-link" target="_blank">我的公众号</a>
		</li>
		
		<li class="menu-item">
			<a href="https://tech.meituan.com/" class="menu-item-link" target="_blank">
				美团技术团队
			</a>
		</li>
		<li class="menu-item">
			<a href="https://tech.youzan.com/" class="menu-item-link" target="_blank">
				有赞技术团队
			</a>
		</li>
		<!--<li class="menu-item">
			<select class="menu-item-link menu-item-select">
				<option class="menu-item-link"  value="volvo">Volvo</option>
				<option class="menu-item-link"  value="saab">Saab</option>
				<option class="menu-item-link"  value="fiat">Fiat</option>
				<option class="menu-item-link"  value="audi">Audi</option>
			</select>
		</li>-->
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="text" placeholder="按目录搜索一下">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										中间件
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/30/%E4%B8%AD%E9%97%B4%E4%BB%B6/Dubbo/">
										Dubbo
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/2022/12/19/%E4%B8%AD%E9%97%B4%E4%BB%B6/Elasticsearch/">
										Elasticsearch
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/30/%E4%B8%AD%E9%97%B4%E4%BB%B6/Netty/">
										Netty
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/19/%E4%B8%AD%E9%97%B4%E4%BB%B6/ZooKeeper/">
										ZooKeeper
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										代码思想
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E4%BB%A3%E7%A0%81%E6%80%9D%E6%83%B3/%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84/">
										代码重构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										前端相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/CSS/">
										CSS
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/Vue/">
										Vue
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/12/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">
										小程序
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										基础知识
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/11/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Go%E5%9F%BA%E7%A1%80/">
										Go基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/27/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/JVM/">
										JVM
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/21/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/Java%E5%9F%BA%E7%A1%80/">
										Java基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%88%86%E5%B8%83%E5%BC%8F/">
										分布式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/10/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">
										并发编程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
										设计模式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										娱乐相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/27/%E5%A8%B1%E4%B9%90%E7%9B%B8%E5%85%B3/%E4%B9%A6%E7%B1%8D/">
										书籍
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E5%A8%B1%E4%B9%90%E7%9B%B8%E5%85%B3/%E7%94%B5%E5%BD%B1/">
										电影
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/05/%E5%A8%B1%E4%B9%90%E7%9B%B8%E5%85%B3/%E7%9F%A5%E8%AF%86/">
										知识
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E5%A8%B1%E4%B9%90%E7%9B%B8%E5%85%B3/%E9%9F%B3%E4%B9%90/">
										音乐
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习专栏
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E4%BB%A3%E7%A0%81%E4%B9%8B%E4%B8%91/">
										代码之丑
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E5%AD%A6%E4%B9%A0%E4%B8%93%E6%A0%8F/%E5%A4%A7%E5%8E%82%E6%99%8B%E5%8D%87%E6%8C%87%E5%8D%97/">
										大厂晋升指南
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习书籍
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/16/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/Java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/">
										Java开发手册
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										工具相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Arthas/">
										Arthas
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/01/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/Maven/">
										Maven
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/">
										实用工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">
										开发工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										成长相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/">
										技术学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E6%88%90%E9%95%BF%E7%9B%B8%E5%85%B3/%E9%9D%A2%E8%AF%95%E7%9B%B8%E5%85%B3/">
										面试相关
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										数据库
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/27/%E6%95%B0%E6%8D%AE%E5%BA%93/HBase/">
										HBase
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/09/%E6%95%B0%E6%8D%AE%E5%BA%93/MongoDB/">
										MongoDB
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/02/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/">
										MySQL
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/21/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/">
										Redis
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										服务器
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%9C%8D%E5%8A%A1%E5%99%A8/Docker/">
										Docker
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E6%9C%8D%E5%8A%A1%E5%99%A8/Nginx/">
										Nginx
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/03/%E6%9C%8D%E5%8A%A1%E5%99%A8/Tomcat/">
										Tomcat
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/09/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E8%BF%90%E7%BB%B4%E7%9F%A5%E8%AF%86/">
										运维知识
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										架构相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/21/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/DDD/">
										DDD
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E6%9E%B6%E6%9E%84%E5%9B%BE/">
										架构图
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/02/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0/">
										架构学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E4%BF%9D%E9%9A%9C/">
										系统保障
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/31/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD/">
										系统性能
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/26/%E6%9E%B6%E6%9E%84%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">
										系统设计
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										框架相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/15/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/JWT/">
										JWT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/MyBatis/">
										MyBatis
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/14/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/RPC%E6%A1%86%E6%9E%B6/">
										RPC框架
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/14/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Spring/">
										Spring
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/03/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/Thrift/">
										Thrift
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
										开源框架
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										消息队列
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/KAFKA/">
										KAFKA
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/07/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RocketMQ/">
										RocketMQ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										算法相关
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/11/26/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/LeetCode/">
										LeetCode
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/26/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/%E5%89%91%E6%8C%87OFFER/">
										剑指OFFER
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/25/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/%E9%9D%A2%E8%AF%95%E7%AE%97%E6%B3%95/">
										面试算法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										英语相关
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										老友记
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%B8%80%E5%AD%A3/">
										第一季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/08/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E8%80%81%E5%8F%8B%E8%AE%B0/%E7%AC%AC%E4%B8%89%E5%AD%A3/">
										第三季
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										雅思
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/12/%E8%8B%B1%E8%AF%AD%E7%9B%B8%E5%85%B3/%E9%9B%85%E6%80%9D/%E5%89%91%E6%A1%A5%E9%9B%85%E6%80%9D%E5%90%AC%E5%8A%9B%E7%9C%9F%E9%A2%98/">
										剑桥雅思听力真题
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										计算机基础
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
										操作系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
										数据结构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/10/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86/">
										算法知识
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/12/19/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">
										网络基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">

	Elasticsearch
</h1>
<div class="article-meta">
	<span>月伴飞鱼</span>
	<span>2022-12-19 22:54:25</span>
    
		<div id="article-categories">
            
                
                    <span>
                        <i class="fa fa-folder" aria-hidden="true"></i>
                        <a href="/categories/中间件/">中间件</a>
						
                    </span>
                
            
		</div>
    
</div>

<div id="container" class = "content999" oncontextmenu="return false;">
	<div id="article-content">
		<p>Elasticsearch 是一个开源的搜索引擎，建立在全文搜索引擎库 Apache Lucene 基础之上。</p>
<blockquote>
<p>ES用 Java 编写，内部使用 Lucene 做索引与搜索：</p>
<ul>
<li>使全文检索变得简单，隐藏 Lucene 的复杂性，提供一套简单的 RESTful API。</li>
</ul>
</blockquote>
<p><strong>学习资源</strong></p>
<blockquote>
<p>官网文档：<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html</a></p>
<p>中文权威指南：<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html">https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html</a></p>
</blockquote>
<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p><strong>index索引</strong></p>
<blockquote>
<p>类比称mysql中的database数据库，存储数据的地方。</p>
</blockquote>
<p><strong>type类型</strong></p>
<blockquote>
<p>用于定义数据结构，类似mysql的一张表，属于index中的逻辑分类。</p>
</blockquote>
<p><strong>mapping</strong></p>
<blockquote>
<p>定义存储字段类型。</p>
</blockquote>
<p><strong>document</strong></p>
<blockquote>
<p>类比mysql中一行数据，不同之处在于es中每个文档可以有不同的字段。</p>
</blockquote>
<p><strong>field字段</strong></p>
<blockquote>
<p>类比mysql中的字段，属于es的最小单位。</p>
</blockquote>
<p><strong>正排索引</strong></p>
<blockquote>
<p>文档ID到文档内容、单词的关联关系。</p>
</blockquote>
<p><strong>倒排索引</strong></p>
<blockquote>
<p>单词到文档ID的关联关系。</p>
<p>倒排索引主要包含两个部分。</p>
<p>单词词典：</p>
<ul>
<li><p>记录所有文档的单词。</p>
</li>
<li><p>记录单词到倒排列表的关联信息。</p>
</li>
</ul>
<p>倒排列表：</p>
<ul>
<li>记录了单词对应的文档集合，由倒排索引项组成。</li>
</ul>
<p>倒排索引项包含如下信息：</p>
<ul>
<li>文档ID，用于获取原始信息。</li>
<li>单词频率，记录该单词在该文档中的出现次数，用于后续相关性算分。</li>
<li>位置，记录单词在文档中的位置，用于做词语搜索。</li>
<li>偏移，记录单词在文档的开始和结束位置，用于做高亮显示。</li>
</ul>
</blockquote>
<p><strong>Term和Match</strong></p>
<blockquote>
<p>Term：</p>
<ul>
<li>完全匹配，精确查询，搜索前不会再对搜索词进行分词拆解。</li>
</ul>
<p>Match：</p>
<ul>
<li>搜索的时会先进行分词拆分，拆完后，再来匹配。</li>
</ul>
</blockquote>
<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p><strong>基本语法</strong></p>
<blockquote>
<p><strong>query</strong>：</p>
<ul>
<li>代表查询，搜索 类似于SQL的select关键字。</li>
</ul>
<p><strong>aggs</strong>：</p>
<ul>
<li>代表聚合，类似于SQL的group by关键字，对查询出来的数据进行聚合，求平均值最大值等。</li>
</ul>
<p><strong>highlight</strong>：</p>
<ul>
<li>对搜索出来的结果中的指定字段进行高亮显示，搜索 中华人民共和国万岁，结果里面符合搜索关键字 全部是红色的高亮显示。</li>
</ul>
<p><strong>sort</strong>： </p>
<ul>
<li>指定字段对查询结果进行排序显示，类比SQL的order by关键字。</li>
</ul>
<p><strong>from</strong>和<strong>size</strong>： </p>
<ul>
<li>对查询结果分页，类似于SQL的limit关键字。</li>
</ul>
<p><strong>post_filter</strong>：</p>
<ul>
<li>后置过滤器，在聚合查询结果之后，再对查询结果进行过滤。</li>
</ul>
</blockquote>
<p><strong>字段类型</strong></p>
<blockquote>
<p>string类型</p>
<p>text类型</p>
<p>keyword类型</p>
<p>数值类型</p>
<p>日期类型</p>
<p>布尔类型</p>
<p>二进制</p>
</blockquote>
<h1 id="分词"><a href="#分词" class="headerlink" title="分词"></a>分词</h1><blockquote>
<p>分词是指将文本转换成一系列单词的过程，也叫做文本分析。</p>
</blockquote>
<p><strong>内置分词器</strong></p>
<blockquote>
<p>Standard Analyzer：默认分词器，按词切分，小写处理。</p>
</blockquote>
<h1 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h1><p><strong>分片</strong></p>
<blockquote>
<p>分片是数据的容器，文档保存在分片内，分片又被分配到集群内的各个节点里。</p>
<p>单台机器无法存储大量数据，es可以将一个索引中的数据切分称多个shard，分布在多台机器上存储。</p>
<ul>
<li>有了shard就可以横向扩展，存储更多数据。</li>
</ul>
</blockquote>
<p>主分片：</p>
<blockquote>
<p>在索引建立的时候就已经确定了主分片数，但是副本分片数可以随时修改。</p>
<p>索引内任意一个文档都归属于一个主分片，所以主分片的数目决定着索引能够保存的最大数据量。</p>
</blockquote>
<p>副分片：</p>
<blockquote>
<p>一个副本分片只是一个主分片的拷贝。</p>
<p>副本分片作为硬件故障时保护数据不丢失的冗余备份，并为搜索和返回文档等读操作提供服务。</p>
</blockquote>
<p>文档到分片的映射算法:</p>
<blockquote>
<p>Hash保证数据均匀分布在分片中，Routing作为关键参数，默认为文档ID，<code>number_of_primary_shards</code>为主分片数。</p>
<ul>
<li>主分片数一旦设定，不能更改，为了保证文档对应的分片不会发生改变。</li>
</ul>
</blockquote>
<pre><code>shard = hash(routing)%number_of_primary_shards
</code></pre>
<p><strong>集群健康状态</strong></p>
<blockquote>
<p>ES的健康状态分为三种：</p>
<ul>
<li><p>Greed，绿色：表示所有主分片和副本分片都正常分配。</p>
</li>
<li><p>Yellow，黄色：表示所有主分片都正常分配，但有副本分片未分配。</p>
</li>
<li><p>Red，红色：表示有主分片未分配。</p>
</li>
</ul>
</blockquote>
<h1 id="ELK"><a href="#ELK" class="headerlink" title="ELK"></a>ELK</h1><p>ELK是一套完整的日志收集以及展示的解决方案，分别是ElasticSearch、Logstash 和 Kibana。</p>
<blockquote>
<p>Logstash：一个具有实时传输能力的数据收集引擎，用来进行数据收集（如：读取文本文件）、解析，并将数据发送给ES。</p>
<p>Kibana：提供了分析和可视化的 Web 平台，可以在 Elasticsearch 的索引中查找，交互数据，并生成各种维度表格、图形。</p>
</blockquote>
<p><strong>常见架构</strong></p>
<blockquote>
<p>这种架构对数据源服务器（即应用服务器）性能影响较大。</p>
<p>因为Logsash是需要安装和运行在需要收集的数据源服务器（即应用服务器）中，然后将收集到的数据实时进行过滤，过滤环节很耗时间和资源，过滤完成后才传输到ES中。</p>
</blockquote>
<p><img src="/images/image-20231019173744407.png" alt="image-20231019173744407"></p>
<p><strong>优化架构</strong></p>
<blockquote>
<p>FileBeat采集日志有效降低了收集日志对业务系统的系统资源的消耗。</p>
<p>通过LogStash服务器可以过滤，转换日志，这样即满足了日志的过滤转换，也保障了业务系统的性能。</p>
</blockquote>
<p><img src="/images/image-20231019181152289.png" alt="image-20231019181152289"></p>
<p>如果日志文件量特别大，以及收集的服务器日志比较多，需加入消息中间件做一下缓冲。</p>
<p><img src="/images/image-20231019191726484.png" alt="image-20231019191726484"></p>
<h1 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h1><p><strong>数据预热</strong></p>
<blockquote>
<p>对于那些比较热的，经常会有人访问的数据，<strong>做一个专门的缓存预热子系统</strong>，对热数据每隔一段时间，就提前访问一下，让数据进入 ES内存 里面去，这样下次别人访问的时候，一定性能会好一些。</p>
</blockquote>
<p><strong>冷热分离</strong></p>
<blockquote>
<p>将冷数据写入一个索引中，然后热数据写入另外一个索引中。</p>
<p>这样可以确保热数据在被预热之后，尽量都让他们留在 ES内存 里，别让冷数据给冲掉。</p>
</blockquote>
<h1 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h1><p><strong>写数据</strong></p>
<blockquote>
<p>在文档写入时，会根据<code>_routing</code>来计算，得出文档要写入哪个分片。</p>
<p>写入请求只会写主分片，当主分片写入成功后，会同时把写入请求发送给所有的副本分片。</p>
<p>当副本分片写入成功后，会传回返回信息给主分片，主分片得到所有副本分片的返回信息后，再返回给客户端。</p>
</blockquote>
<p><strong>搜索数据</strong></p>
<blockquote>
<p>客户端发送请求到一个 coordinate node（调度节点）。</p>
<p>协调节点将搜索请求转发到该索引所有的 shard 对应的 primary shard或 replica shard 上。</p>
<p>query phase：</p>
<ul>
<li>每个 shard 将自己的搜索结果（一些 doc id）返回给协调节点。</li>
<li>由协调节点进行数据的<strong>合并、排序、分页</strong>等操作，产出最终结果。</li>
</ul>
<p>fetch phase（读数据过程）：</p>
<ul>
<li><p>接着由协调节点根据 <code>doc id</code> 去各个节点上拉取实际的 doc 数据，最终返回给客户端。</p>
</li>
<li><p>写请求是写入 primary shard，然后同步给所有的 replica shard。</p>
</li>
<li><p>读请求可以从 primary shard 或 replica shard 读取，采用的是随机轮询算法。</p>
</li>
</ul>
</blockquote>
<p><strong>写入过程</strong></p>
<blockquote>
<p><strong>refresh</strong>：</p>
<ul>
<li><p>ES 接收数据请求时先存入 ES 的内存中，默认每隔一秒会从内存 buffer 中将数据写入操作系统缓存 os cache。</p>
</li>
<li><p>到了 os cache 数据就能被搜索到（所以ES 是近实时的，因为1s 的延迟后执行 refresh 便可让数据被搜索到）。</p>
</li>
</ul>
<p><strong>fsync</strong>：</p>
<ul>
<li>translog 会每隔5秒或者在一个变更请求完成之后执行一次 fsync 操作，将 translog 从缓存刷入磁盘，这个操作比较耗时，如果对数据一致性要求不是跟高时建议将索引改为异步，如果节点宕机时会有5秒数据丢失。</li>
</ul>
<p><strong>flush</strong>：</p>
<ul>
<li>ES 默认每隔30分钟会将 os cache 中的数据刷入磁盘，同时清空 translog 日志文件。</li>
</ul>
<p><strong>merge</strong>：</p>
<ul>
<li>ES 的一个 index 由多个 shard 组成，而一个 shard 其实就是一个 Lucene 的 index，它又由多个 segment 组成，且 Lucene 会不断地把一些小的 segment 合并成一个大的 segment。</li>
<li>执行索引操作时，ES会先生成小的segment，ES 有离线的逻辑对小的 segment 进行合并，优化查询性能。</li>
<li>但是合并过程中会消耗较多磁盘 IO，会影响查询性能。</li>
</ul>
</blockquote>
<p><img src="/images/image-20231111232733271.png" alt="image-20231111232733271"></p>
<p><strong>删除和更新过程</strong></p>
<blockquote>
<p>删除和更新都是写操作，但是<strong>由于 Elasticsearch 中的文档是不可变的</strong>，因此不能被删除或者改动以展示其变更。</p>
<ul>
<li><strong>所以 ES 利用 .del 文件 标记文档是否被删除</strong>，磁盘上的每个段都有一个相应的<code>.del</code> 文件。</li>
</ul>
<p>如果是删除操作，文档其实并没有真的被删除，而是在 <code>.del</code> 文件中被标记为 deleted 状态。</p>
<ul>
<li>该文档依然能匹配查询，但是会在结果中被过滤掉。</li>
</ul>
<p>如果是更新操作，就是将旧的 doc 标识为 deleted 状态，然后创建一个新的 doc。</p>
<p>每次segment merge 的时候，会将多个 segment 文件合并成一个，<strong>同时这里会将标识为 deleted 的 doc 给物理删除掉</strong>，不写入到新的 segment 中，然后将新的 segment 文件写入磁盘，这里会写一个 commit point ，标识所有新的 segment 文件，然后打开 segment 文件供搜索使用，同时删除旧的 segment 文件。</p>
</blockquote>
<p><strong>搜索过程</strong></p>
<blockquote>
<p>搜索分为两个阶段执行，Query、Fetch。</p>
<p>Query：</p>
<ul>
<li>客户端发送请求到 coordinate node，协调节点将搜索请求广播到所有的 primary shard 或 replica shard。</li>
<li>每个分片在本地执行搜索并构建一个匹配文档的大小为 from + size 的优先队列。</li>
<li>每个分片返回各自优先队列中 所有文档的 ID 和排序值 给协调节点，由协调节点及逆行数据的合并、排序、分页等操作，产出最终结果。</li>
</ul>
<p>Fetch：</p>
<ul>
<li>协调节点根据 doc id 去各个节点上查询实际的 document 数据，由协调节点返回结果给客户端。</li>
<li>coordinate node 对 doc id 进行哈希路由，将请求转发到对应的 node，此时会使用 round-robin 随机轮询算法，在 primary shard 以及其所有 replica 中随机选择一个，让读请求负载均衡。</li>
<li>接收请求的 node 返回 document 给 coordinate node。</li>
<li>coordinate node 返回 document 给客户端。</li>
</ul>
</blockquote>
<h1 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h1><p><strong>深度分页</strong></p>
<table>
<thead>
<tr>
<th align="left">分页方式</th>
<th align="left">性能</th>
<th align="left">优点</th>
<th align="left">缺点</th>
<th align="left">场景</th>
</tr>
</thead>
<tbody><tr>
<td align="left">from + size</td>
<td align="left">低</td>
<td align="left">灵活性好，实现简单</td>
<td align="left">深度分页问题</td>
<td align="left">数据量比较小，能容忍深度分页问题</td>
</tr>
<tr>
<td align="left">scroll</td>
<td align="left">中</td>
<td align="left">解决了深度分页问题</td>
<td align="left">无法反应数据的实时性（快照版本）维护成本高，需要维护一个 <code>scroll_id</code></td>
<td align="left">海量数据的导出需要查询海量结果集的数据</td>
</tr>
<tr>
<td align="left"><code>search_after</code></td>
<td align="left">高</td>
<td align="left">性能最好不存在深度分页问题能够反映数据的实时变更</td>
<td align="left">实现复杂，需要有一个全局唯一的字段连续分页的实现会比较复杂，因为每一次查询都需要上次查询的结果，它不适用于大幅度跳页查询</td>
<td align="left">海量数据的分页</td>
</tr>
</tbody></table>
<blockquote>
<p>如果数据量小（from+size在10000条内），或者只关注结果集的TopN数据，可以使用from&#x2F;size 分页。</p>
<p>数据量大，深度翻页，后台批处理任务（数据迁移）之类的任务，使用 scroll 方式。</p>
<p>数据量大，深度翻页，用户实时、高并发查询需求，使用 search after 方式。</p>
</blockquote>
<p>From&#x2F;Size参数：</p>
<blockquote>
<p>在ES中，分页查询默认返回最顶端的10条匹配hits。</p>
<p>如果需要分页，需要使用from和size参数。</p>
<ul>
<li>from参数：需要跳过的hits数，默认为0。</li>
<li>size参数：需要返回的hits数目的最大值。</li>
</ul>
<p>这里表示从搜索结果中取第100条开始的10条数据。</p>
</blockquote>
<pre><code class="json">POST /my_index/my_type/_search
&#123;
    &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125;&#125;,
    &quot;from&quot;: 100,
    &quot;size&quot;:  10
&#125;
</code></pre>
<p>Scroll：</p>
<blockquote>
<p>可以把Scroll理解为关系型数据库里的Cursor，并不适合用来做实时搜索，而更适合用于后台批处理任务，比如群发。</p>
<ul>
<li>Scroll不是为了实时查询数据，而是为了一次性查询大量的数据（甚至是全部的数据）。</li>
</ul>
<p>Scroll相当于维护了一份当前索引段的快照信息，这个快照信息是你执行这个Scroll查询时的快照。</p>
<ul>
<li>在这个查询后的任何新索引进来的数据，都不会在这个快照中查询到。</li>
</ul>
<p>Scroll可以分为初始化和遍历两部分：</p>
<ul>
<li><p>初始化时：将所有符合搜索条件的搜索结果缓存起来（注意：这里只是缓存的<code>doc_id</code>，而并不是真的缓存了所有的文档数据，取数据是在fetch阶段完成的），可以想象成快照。</p>
</li>
<li><p>遍历时：从这个快照里取数据，也就是说，在初始化后，对索引插入、删除、更新数据都不会影响遍历结果。</p>
</li>
</ul>
</blockquote>
<pre><code class="json">POST /twitter/tweet/_search?scroll=1m
&#123;
    &quot;size&quot;: 100,
    &quot;query&quot;: &#123;
        &quot;match&quot; : &#123;
            &quot;title&quot; : &quot;elasticsearch&quot;
        &#125;
    &#125;
&#125;
</code></pre>
<blockquote>
<p>初始化指明 index 和 type，然后，加上参数 scroll，表示暂存搜索结果的时间。</p>
<p>会返回一个<code>_scroll_id</code>，<code>_scroll_id</code>用来下次取数据用。</p>
<p>缺点：</p>
<ul>
<li><code>scroll_id</code>会占用大量的资源（特别是排序的请求）。</li>
<li>Scroll后接超时时间，频繁的发起Scroll请求，会出现一些列问题。</li>
<li>生成的历史快照，对于数据的变更不会反映到快照上。</li>
</ul>
<p>优点：</p>
<ul>
<li>适用于非实时处理大量数据的情况，比如要进行数据迁移或者索引变更之类的。</li>
</ul>
</blockquote>
<pre><code class="json">POST /_search?scroll=1m
&#123;
    &quot;scroll_id&quot;:&quot;XXXXXXXXXXXXXXXXXXXXXXX I am scroll id XXXXXXXXXXXXXXX&quot;
&#125;
</code></pre>
<p>Scroll Scan:</p>
<blockquote>
<p>ES提供了Scroll Scan方式进一步提高遍历性能，但是Scroll Scan不支持排序，因此Scroll Scan适合不需要排序的场景。</p>
<ul>
<li><code>search_type</code>：赋值为scan，表示采用 Scroll Scan 的方式遍历，同时告诉 Elasticsearch 搜索结果不需要排序。</li>
<li>scroll：传时间。</li>
<li>size：表示的是每个 shard 返回的 size 数，最终结果最大为 <code>number_of_shards * size</code>。</li>
</ul>
<p>Scroll Scan与Scroll的区别：</p>
<ul>
<li>没有排序，按index顺序返回，没有排序，可以提高取数据性能。</li>
<li>初始化时只返回 <code>_scroll_id</code>，没有具体的hits结果。</li>
<li>size控制的是每个分片的返回的数据量，而不是整个请求返回的数据量。</li>
</ul>
</blockquote>
<pre><code class="json">POST /my_index/my_type/_search?search_type=scan&amp;scroll=1m&amp;size=50
&#123;
 &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125;&#125;
&#125;
</code></pre>
<p>Sliced Scroll：</p>
<blockquote>
<p>每个Scroll请求，可以分成多个Slice请求，可以理解为切片，各Slice独立并行，比用Scroll遍历要快很多倍。</p>
</blockquote>
<pre><code class="json">POST /index/type/_search?scroll=1m
&#123;
    &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125;&#125;,
    &quot;slice&quot;: &#123;
        &quot;id&quot;: 0,
        &quot;max&quot;: 5
    &#125;   
&#125;
 
POST ip:port/index/type/_search?scroll=1m
&#123;
    &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125;&#125;,
    &quot;slice&quot;: &#123;
        &quot;id&quot;: 1,
        &quot;max&quot;: 5
    &#125;   
&#125;
</code></pre>
<p>Search After:</p>
<blockquote>
<p><code>Search_after</code>是 ES5 新引入的一种分页查询机制，其原理几乎就是和Scroll一样的。</p>
<p><code>SEARCH_AFTER</code>不是自由跳转到任意页面的解决方案，而是并行滚动多个查询的解决方案。</p>
</blockquote>

	</div>
</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/2023/10/07/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  开发工具
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2022/12/19/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">
                网络基础
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>




<script>

    //document.oncontextmenu=new Function("event.returnValue=false");
	//document.onselectstart=new Function("event.returnValue=false");

	

	$(function () {
		const btw = new BTWPlugin();
	    btw.init({
	        id: 'container',
	        blogId: '22377-1700273503597-982',
	        name: '月伴飞鱼',
	        qrcode: '/小程序码.jpg',
	        keyword: '验证码',
	    });

	    var contents = document.getElementsByClassName("content999");
	    //监听文章内容的copy事件
	    contents[0].addEventListener('copy',function(e){
	        setClipboardText(e);
	    });

	    function setClipboardText(event){
	        // clipboardData 对象是为通过编辑菜单、快捷菜单和快捷键执行的编辑操作所保留的，也就是你复制或者剪切内容
	        let clipboardData = event.clipboardData || window.clipboardData;

	        // 如果未复制或者未剪切，则return出去
	        if (!clipboardData) { return; }

	        event.preventDefault();

	        // Selection 对象，表示用户选择的文本范围或光标的当前位置。
	        // 声明一个变量接收 -- 用户输入的剪切或者复制的文本转化为字符串
	        let text = window.getSelection().toString();
	    
	        if (text) {
	            // 如果文本存在则先取消文本默认事件
	            event.preventDefault();
	            // 通过调用常clipboardData对象的 setData(format, data) 方法；来设置相关文本
	            // format: 一个DOMString 表示要添加到 drag object的拖动数据的类型。
	            // data: 一个 DOMString表示要添加到 drag object的数据。
	            var copyright = '\n\n'
	            + '\n著作权归作者所有。'
	            + '\n商业转载请联系作者获得授权，非商业转载请注明出处。'
	            + '\n作者: 月伴飞鱼'
	            + '\n原文地址: https://hardyfish.top/2022/12/19/%E4%B8%AD%E9%97%B4%E4%BB%B6/Elasticsearch/'
	    
	            clipboardData.setData('text/plain', text + copyright);
	    
	        }
	    };
	});

	
</script>

<script>
    const btw = new BTWPlugin();
    btw.init({
        id: 'container',
        blogId: '22377-1700273503597-982',
        name: '月伴飞鱼',
        qrcode: '/小程序码.jpg',
        keyword: '验证码',
    });
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">月伴飞鱼</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			PV 180986
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			UV 10079
		</span>
	
	<br>
	微信搜索 <a href="https://xiaoflyfish.oss-cn-beijing.aliyuncs.com/image/个人公众号.jpg" target="_blank">月伴飞鱼</a> 关注我
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>